default_level <- c('Bad','Good')
Defaults_1_model <- matrix(c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835,0.00222,0.99778,0.00261,0.99739,
0.00112,0.99888,0.00110,0.9989,0.00130,0.9987,0.00132,0.99868,0.00186,0.99814,0.00204,0.99796,0.00236,0.99764,0.00302,0.99698,
0.00115,0.99885,0.00130,0.9987,0.00132,0.99868,0.00162,0.99838,0.00224,0.99776,0.00249,0.99751,0.00311,0.99689,0.00399,0.99601,
0.00136,0.99864,0.00162,0.99838,0.00169,0.99831,0.00167,0.99833,0.00254,0.99746,0.00278,0.99722,0.00369,0.99631,0.00384,0.99616,
0.00133,0.99867,0.00188,0.99812,0.00195,0.99805,0.00181,0.99819,0.00259,0.99741,0.00288,0.99712,0.00393,0.99607,0.00466,0.99534,
0.00179,0.99821,0.00176,0.99824,0.00175,0.99825,0.00181,0.99819,0.00281,0.99719,0.00307,0.99693,0.00386,0.99614,0.00403,0.99597))
dim(Defaults_1_model) <- c(2,8,6)
dimnames(Defaults_1_model) <- list('Defaults_1'=default_level,'LTV_1'=ltv_level,'DTI_1'=dti_level)
networkstring <- "[LTV_1][Income_1][Inflation_1|Income_1][BoERates_1|Inflation_1:Income_1][DTI_1|Income_1:BoERates_1][Defaults_1|DTI_1:LTV_1]"
net <- model2network(networkstring)
nnodes <- list(Income_1,Inflation_1,BoERates_1,DTI_1,LTV_1,Defaults_1)
cgfit <- fit.net.z(nnodes,net)
Defaults_1_model
net <- model2network("[Income_1][Inflation_1|Income_1][BoERates_1|Income_1:Inflation_1][DTI_1|Income_1:BoERates_1][LTV_1]")
custom.fit(net,dist=list(Income_1=Income_1_model,Inflation_1=Inflation_1_model,BoERates_1=BoERates_1_model,DTI_1=DTI_1_model,LTV_1=LTV_1_model))
net <- model2network("[Income_1][Inflation_1|Income_1][BoERates_1|Income_1:Inflation_1][DTI_1|Income_1:BoERates_1][LTV_1][Defaults_1|LTV_1:DTI_1]")
custom.fit(net,dist=list(Income_1=Income_1_model,Inflation_1=Inflation_1_model,BoERates_1=BoERates_1_model,DTI_1=DTI_1_model,LTV_1=LTV_1_model,Defaults_1=Defaults_1_model))
net <- model2network("[LTV_1]")
custom.fit(net,dist=list(LTV_1=LTV_1_model))
net <- model2network("[LTV_1][DTI_1]")
custom.fit(net,dist=list(LTV_1=LTV_1_model,DTI_1=DTI_1_model))
net <- model2network("[LTV_1][DTI_1][Defaults_1|LTV_1:DTI_1]")
defaults_level <- c('1','0')
Defaults_1_model <- matrix(c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835,0.00222,0.99778,0.00261,0.99739,
0.00112,0.99888,0.00110,0.9989,0.00130,0.9987,0.00132,0.99868,0.00186,0.99814,0.00204,0.99796,0.00236,0.99764,0.00302,0.99698,
0.00115,0.99885,0.00130,0.9987,0.00132,0.99868,0.00162,0.99838,0.00224,0.99776,0.00249,0.99751,0.00311,0.99689,0.00399,0.99601,
0.00136,0.99864,0.00162,0.99838,0.00169,0.99831,0.00167,0.99833,0.00254,0.99746,0.00278,0.99722,0.00369,0.99631,0.00384,0.99616,
0.00133,0.99867,0.00188,0.99812,0.00195,0.99805,0.00181,0.99819,0.00259,0.99741,0.00288,0.99712,0.00393,0.99607,0.00466,0.99534,
0.00179,0.99821,0.00176,0.99824,0.00175,0.99825,0.00181,0.99819,0.00281,0.99719,0.00307,0.99693,0.00386,0.99614,0.00403,0.99597))
dim(Defaults_1_model) <- c(2,8,6)
dimnames(Defaults_1_model) <- list('Defaults_1'=defaults_level,'LTV_1'=ltv_level,'DTI_1'=dti_level)
custom.fit(net,dist=list(LTV_1=LTV_1_model,DTI_1=DTI_1_model,Defaults_1=Defaults_1_model))
ltv_level <-c('<20%','20%-30%')
LTV_1_model <- matrix(c(0.4,0.6),ncol=2,dimnames=list(NULL,'LTV_1'=ltv_level))
LTV_1_model
dti_level <- c('<5%','5%-10%')
DTI_1_model <- matrix(c(0.84,0.16),ncol=2,dimnames=list(NULL,'DTI_1'=dti_level)
)
DTI_1_model
defaults_level  <- c('1','0')
Defaults_1_model <- matrix(c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9))
dim(Defaults_1_model) <- c(2,2,2)
Defaults_1_model
dimnames(Defaults_1_model)  <- list('Defaults_1'=defaults_level,'LTV_1'=ltv_level,'DTI_1'=dti_level)
net  <- model2network("[LTV_1][DTI_1][Defaults_1|LTV_1:DTI_1]")
custom.fit(net,dist=list(LTV_1=LTV_1_model,DTI_1=DTI_1_model,Defaults_1=Defaults_1_model))
dti_level <- c('<5%','5%-10%','10%-15%','15%-20%','20%-25%','25%+')
DTI_1_model <- matrix(c(0.13,0.14,0.15,0.16,0.18,0.24),ncol=6,dimnames=list(NULL,'DTI_1'=dti_level))
DTI_1_model
aaa <- c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835,0.00222,0.99778,0.00261,0.99739,
0.00112,0.99888,0.00110,0.9989,0.00130,0.9987,0.00132,0.99868,0.00186,0.99814,0.00204,0.99796,0.00236,0.99764,0.00302,0.99698)
length(aaa)
aaa[1:24]
Defaults_1_model <- matrix(c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835,0.00222,0.99778,0.00261,0.99739,
0.00112,0.99888,0.00110,0.9989,0.00130,0.9987,0.00132,0.99868))
dim(Defaults_1_model) <- c(2,2,6)
defaults_level  <- c('1','0')
dimnames(Defaults_1_model)  <- list('Defaults_1'=defaults_level,'LTV_1'=ltv_level,'DTI_1'=dti_level)
Defaults_1_model
net  <- model2network("[LTV_1][DTI_1][Defaults_1|LTV_1:DTI_1]")
custom.fit(net,dist=list(LTV_1=LTV_1_model,DTI_1=DTI_1_model,Defaults_1=Defaults_1_model))
ltv_level <-c('<20%','20%-30%')
LTV_1_model <- matrix(c(0.4,0.6),ncol=2,dimnames=list(NULL,'LTV_1'=ltv_level))
dti_level <- c('<5%','5%-10%','10%-15%')
DTI_1_model <- matrix(c(0.3,0.3,0.4),ncol=3,dimnames=list(NULL,'DTI_1'=dti_level))
Defaults_1_model <- matrix(c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835))
dim(Defaults_1_model) <- c(2,2,6)
defaults_level  <- c('1','0')
dimnames(Defaults_1_model)  <- list('Defaults_1'=defaults_level,'LTV_1'=ltv_level,'DTI_1'=dti_level)
dim(Defaults_1_model) <- c(2,2,3)
defaults_level  <- c('1','0')
dimnames(Defaults_1_model)  <- list('Defaults_1'=defaults_level,'LTV_1'=ltv_level,'DTI_1'=dti_level)
net  <- model2network("[LTV_1][DTI_1][Defaults_1|LTV_1:DTI_1]")
custom.fit(net,dist=list(LTV_1=LTV_1_model,DTI_1=DTI_1_model,Defaults_1=Defaults_1_model))
ltv_level <-c('<20%','20%-30%')
LTV_1_model <- matrix(c(0.4,0.6),ncol=2,dimnames=list(NULL,'LTV_1'=ltv_level))
dti_level <- c('<5%','5%-10%')
DTI_1_model <- matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,'DTI_1'=dti_level))
Defaults_1_model <- matrix(c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9))
dim(Defaults_1_model) <- c(2,2,2)
defaults_level  <- c('1','0')
dimnames(Defaults_1_model)  <- list('Defaults_1'=defaults_level,'LTV_1'=ltv_level,'DTI_1'=dti_level)
net  <- model2network("[LTV_1][DTI_1][Defaults_1|LTV_1:DTI_1]")
custom.fit(net,dist=list(LTV_1=LTV_1_model,DTI_1=DTI_1_model,Defaults_1=Defaults_1_model))
Defaults_1_model <- matrix(c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835))
dim(Defaults_1_model) <- c(2,3,2)
defaults_level  <- c('1','0')
dimnames(Defaults_1_model)  <- list('Defaults_1'=defaults_level,'LTV_1'=ltv_level,'DTI_1'=dti_level)
ltv_level <-c('<20%','20%-30%','30%-40%')
LTV_1_model <- matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,'LTV_1'=ltv_level))
dti_level <- c('<5%','5%-10%')
DTI_1_model <- matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,'DTI_1'=dti_level))
Defaults_1_model <- matrix(c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835))
dim(Defaults_1_model) <- c(2,3,2)
defaults_level  <- c('1','0')
dimnames(Defaults_1_model)  <- list('Defaults_1'=defaults_level,'LTV_1'=ltv_level,'DTI_1'=dti_level)
net  <- model2network("[LTV_1][DTI_1][Defaults_1|LTV_1:DTI_1]")
custom.fit(net,dist=list(LTV_1=LTV_1_model,DTI_1=DTI_1_model,Defaults_1=Defaults_1_model))
data(learning.test)
library(bnlearn)
data(learning.test)
new.cpt = matrix(c(0.1, 0.2, 0.3, 0.2, 0.5, 0.6, 0.7, 0.3, 0.1),
byrow = TRUE, ncol = 3,
dimnames = list(B = c("a", "b", "c"), A = c("a", "b", "c")))
new.cpt
net = model2network("[A][B][C|A:B]")
cptA = matrix(c(0.4, 0.2,0.4), ncol = 3, dimnames = list(NULL, c("LOW","Middle", "HIGH")))
cptB = matrix(c(0.4,0.4, 0.2), ncol = 3, dimnames = list(NULL, c("GOOD","unknown", "BAD")))
cptC = c(0.5, 0.5, 0.4, 0.6, 0.3, 0.7, 0.2, 0.8,0.1,0.9,0.3,0.7,0.5,0.5,0.8,0.2,0.4,0.6)
dim(cptC)=c(2,3,3)
dimnames(cptC)= list("C" = c("TRUE", "FALSE"), "A" =   c("LOW","Middle", "HIGH"),
"B" = c("GOOD","unknown", "BAD"))
cfit = custom.fit(net, dist = list(A = cptA, B = cptB, C = cptC))
ltv_level <-c('<20%','20%-30%','30%-40%')
LTV_1_model <- matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,'LTV_1'=ltv_level))
dti_level <- c('<5%','5%-10%')
DTI_1_model <- matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,'DTI_1'=dti_level))
Defaults_1_model <- matrix(c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835))
dim(Defaults_1_model) <- c(2,3,2)
defaults_level  <- c('1','0')
dimnames(Defaults_1_model)  <- list('Defaults_1'=defaults_level,'LTV_1'=ltv_level,'DTI_1'=dti_level)
net  <- model2network("[LTV_1][DTI_1][Defaults_1|LTV_1:DTI_1]")
custom.fit(net,dist=list(LTV_1=LTV_1_model,DTI_1=DTI_1_model,Defaults_1=Defaults_1_model))
net = model2network("[A][B][C|A:B]")
cptA = matrix(c(0.4,0.3,0.3), ncol = 3, dimnames = list(NULL, c("LOW","Middle", "HIGH")))
cptB = matrix(c(0.3,0.7), ncol = 2, dimnames = list(NULL, c("GOOD", "BAD")))
cptC = c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptC)=c(2,3,2)
dimnames(cptC)= list("C" = c("TRUE", "FALSE"), "A" =   c("LOW","Middle", "HIGH"),
"B" = c("GOOD", "BAD"))
cfit = custom.fit(net, dist = list(A = cptA, B = cptB, C = cptC))
net  <- model2network("[LTV_1][DTI_1][Defaults_1|LTV_1:DTI_1]")
ltv_level <-c('<20%','20%-30%','30%-40%')
LTV_1_model <- matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,"LTV_1"=ltv_level))
dti_level <- c('<5%','5%-10%')
DTI_1_model <- matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,"DTI_1"=dti_level))
Defaults_1_model <- matrix(c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835))
dim(Defaults_1_model) <- c(2,3,2)
defaults_level  <- c('1','0')
dimnames(Defaults_1_model)  <- list('Defaults_1'=defaults_level,'LTV_1'=ltv_level,'DTI_1'=dti_level)
net  <- model2network("[LTV_1][DTI_1][Defaults_1|LTV_1:DTI_1]")
custom.fit(net,dist=list(LTV_1=LTV_1_model,DTI_1=DTI_1_model,Defaults_1=Defaults_1_model))
net  <- model2network("[LTV_1][DTI_1][Defaults_1|LTV_1:DTI_1]")
ltv_level <-c('<20%','20%-30%','30%-40%')
LTV_1_model1 <- matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,"LTV_1"=ltv_level))
dti_level <- c('<5%','5%-10%')
DTI_1_model1 <- matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,"DTI_1"=dti_level))
Defaults_1_model1 <- matrix(c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835))
dim(Defaults_1_model1) <- c(2,3,2)
defaults_level  <- c('1','0')
dimnames(Defaults_1_model1)  <- list('Defaults_1'=defaults_level,'LTV_1'=ltv_level,'DTI_1'=dti_level)
net  <- model2network("[LTV_1][DTI_1][Defaults_1|LTV_1:DTI_1]")
custom.fit(net,dist=list(LTV_1=LTV_1_model1,DTI_1=DTI_1_model1,Defaults_1=Defaults_1_model1))
ltv_level <-c('<20%','20%-30%','30%-40%')
LTV_1_model1 <- matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,"LTV_2"=ltv_level))
dti_level <- c('<5%','5%-10%')
DTI_1_model1 <- matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,"DTI_2"=dti_level))
Defaults_1_model1 <- matrix(c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835))
dim(Defaults_1_model1) <- c(2,3,2)
defaults_level  <- c('1','0')
dimnames(Defaults_1_model1)  <- list('Defaults_2'=defaults_level,'LTV_2'=ltv_level,'DTI_2'=dti_level)
net  <- model2network("[LTV_2][DTI_2][Defaults_2|LTV_2:DTI_2]")
custom.fit(net,dist=list(LTV_2=LTV_1_model1,DTI_2=DTI_1_model1,Defaults_2=Defaults_1_model1))
ltv_level <-c('<20%','20%-30%','30%-40%')
LTV_1_model1 <- matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
dti_level <- c('<5%','5%-10%')
DTI_1_model1 <- matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
Defaults_1_model1 <- matrix(c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835))
dim(Defaults_1_model1) <- c(2,3,2)
defaults_level  <- c('1','0')
dimnames(Defaults_1_model1)  <- list('Defaults_2'=defaults_level,'LTV_2'=ltv_level,'DTI_2'=dti_level)
net  <- model2network("[LTV_2][DTI_2][Defaults_2|LTV_2:DTI_2]")
custom.fit(net,dist=list(LTV_2=LTV_1_model1,DTI_2=DTI_1_model1,Defaults_2=Defaults_1_model1))
Defaults_1_model1 <- c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(Defaults_1_model1) <- c(2,3,2)
defaults_level  <- c('1','0')
dimnames(Defaults_1_model1)  <- list('Defaults_2'=defaults_level,'LTV_2'=ltv_level,'DTI_2'=dti_level)
net  <- model2network("[LTV_2][DTI_2][Defaults_2|LTV_2:DTI_2]")
custom.fit(net,dist=list(LTV_2=LTV_1_model1,DTI_2=DTI_1_model1,Defaults_2=Defaults_1_model1))
net  <- model2network("[LTV_2][DTI_2][Defaults_2|LTV_2:DTI_2]")
ltv_level <-c('<20%','20%-30%','30%-40%')
LTV_1_model1 <- matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
LTV_1_model1
dti_level <- c('<5%','5%-10%')
DTI_1_model1 <- matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
DTI_1_model1
Defaults_1_model1 <- c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(Defaults_1_model1) <- c(2,3,2)
defaults_level  <- c('1','0')
dimnames(Defaults_1_model1)  <- list('Defaults_2'=defaults_level,'LTV_2'=ltv_level,'DTI_2'=dti_level)
cfit <- custom.fit(net,dist=list(LTV_2=LTV_1_model1,DTI_2=DTI_1_model1,Defaults_2=Defaults_1_model1))
net  <- model2network("[A][B][C|A:B]")
ltv_level <-c('<20%','20%-30%','30%-40%')
cptA <- matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
dti_level <- c('<5%','5%-10%')
cptB <- matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
cptC <- c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptC) <- c(2,3,2)
defaults_level  <- c('1','0')
dimnames(cptC)  <- list('C'=defaults_level,'A'=ltv_level,'B'=dti_level)
net  <- model2network("[A][B][C|A:B]")
cfit <- custom.fit(net,dist=list(A = cptA, B = cptB, C = cptC))
cfit
net  <- model2network("[LTV_1][DTI_1][Defaults_1|LTV_1:DTI_1]")
ltv_level <-c('<20%','20%-30%','30%-40%')
cptLTV <- matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
dti_level <- c('<5%','5%-10%')
cptDTI <- matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
cptDefaults <- c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptDefaults) <- c(2,3,2)
defaults_level  <- c('1','0')
dimnames(cptDefaults)  <- list('Defaults_1'=defaults_level,'LTV_1'=ltv_level,'DTI_1'=dti_level)
#net  <- model2network("[A][B][C|A:B]")
cfit <- custom.fit(net,dist=list(LTV_1 = cptLTV, DTI_1 = cptDTI, Defaults_1 = cptDefaults))
net  <- model2network("[LTV][DTI][Defaults|LTV:DTI]")
ltv_level <-c('<20%','20%-30%','30%-40%')
cptLTV <- matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
dti_level <- c('<5%','5%-10%')
cptDTI <- matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
cptDefaults <- c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptDefaults) <- c(2,3,2)
defaults_level  <- c('1','0')
dimnames(cptDefaults)  <- list('Defaults'=defaults_level,'LTV'=ltv_level,'DTI'=dti_level)
#net  <- model2network("[A][B][C|A:B]")
cfit <- custom.fit(net,dist=list(LTV = cptLTV, DTI = cptDTI, Defaults = cptDefaults))
net = model2network("[A][B][C|A:B]")
cptA = matrix(c(0.4,0.3,0.3), ncol = 3, dimnames = list(NULL, ltv_level))
cptB = matrix(c(0.3,0.7), ncol = 2, dimnames = list(NULL, dti_level))
cptC = c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptC)=c(2,3,2)
dimnames(cptC)= list("C" = defaults_level, "A" =  ltv_level,
"B" = dti_level)
cfit = custom.fit(net, dist = list(A = cptA, B = cptB, C = cptC))
net  <- model2network("[LTV][DTI][C|LTV:DTI]")
ltv_level <-c('<20%','20%-30%','30%-40%')
cptLTV <- matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
dti_level <- c('<5%','5%-10%')
cptDTI <- matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
cptDefaults <- c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptDefaults) <- c(2,3,2)
defaults_level  <- c('1','0')
dimnames(cptDefaults)  <- list('C'=defaults_level,'LTV'=ltv_level,'DTI'=dti_level)
#net  <- model2network("[A][B][C|A:B]")
cfit <- custom.fit(net,dist=list(LTV = cptLTV, DTI = cptDTI, C = cptDefaults))
net = model2network("[A][B][C|A:B]")
cptA = matrix(c(0.4,0.3,0.3), ncol = 3, dimnames = list(NULL, ltv_level))
cptB = matrix(c(0.3,0.7), ncol = 2, dimnames = list(NULL, dti_level))
cptC = c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptC)=c(2,3,2)
dimnames(cptC)= list("C" = defaults_level, "A" =  ltv_level,
"B" = dti_level)
cfit = custom.fit(net, dist = list(A = cptA, B = cptB, C = cptC))
net  = model2network("[LTV][DTI][C|LTV:DTI]")
cptLTV = matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
cptDTI = matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
cptDefaults = c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dimnames(cptDefaults)  = list('C'=defaults_level,'LTV'=ltv_level,'DTI'=dti_level)
dim(cptDefaults) <- c(2,3,2)
dimnames(cptDefaults)  = list('C'=defaults_level,'LTV'=ltv_level,'DTI'=dti_level)
cfit = custom.fit(net,dist=list(LTV = cptLTV, DTI = cptDTI, C = cptDefaults))
net  = model2network("[LTV][DTI][C|LTV:DTI]")
cptLTV = matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
cptDTI = matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
cptDefaults = c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptDefaults) = c(2,3,2)
defaults_level  <- c('1','0')
dimnames(cptDefaults)  = list('C'=defaults_level,'LTV'=ltv_level,'DTI'=dti_level)
cfit = custom.fit(net,dist=list(LTV = cptLTV, DTI = cptDTI, C = cptDefaults))
net  = model2network("[A][B][C|A:B]")
cptLTV = matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
cptDTI = matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
cptDefaults = c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptDefaults) = c(2,3,2)
defaults_level  <- c('1','0')
dimnames(cptDefaults)  = list('C'=defaults_level,'A'=ltv_level,'B'=dti_level)
cfit = custom.fit(net,dist=list(A = cptLTV, B = cptDTI, C = cptDefaults))
net  = model2network("[LTV][B][C|LTV:B]")
cptLTV = matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
cptDTI = matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
cptDefaults = c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptDefaults) = c(2,3,2)
defaults_level  <- c('1','0')
dimnames(cptDefaults)  = list('C'=defaults_level,'LTV'=ltv_level,'B'=dti_level)
cfit = custom.fit(net,dist=list(LTV = cptLTV, B = cptDTI, C = cptDefaults))
net  = model2network("[LTVX][B][C|LTVX:B]")
cptLTV = matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
cptDTI = matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
cptDefaults = c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptDefaults) = c(2,3,2)
defaults_level  <- c('1','0')
dimnames(cptDefaults)  = list('C'=defaults_level,'LTVX'=ltv_level,'B'=dti_level)
cfit = custom.fit(net,dist=list(LTVX = cptLTV, B = cptDTI, C = cptDefaults))
net  = model2network("[DD][B][C|DD:B]")
cptLTV = matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
cptDTI = matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
cptDefaults = c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptDefaults) = c(2,3,2)
defaults_level  <- c('1','0')
dimnames(cptDefaults)  = list('C'=defaults_level,'DD'=ltv_level,'B'=dti_level)
cfit = custom.fit(net,dist=list(DD = cptLTV, B = cptDTI, C = cptDefaults))
net  = model2network("[D][B][C|D:B]")
cptLTV = matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
cptDTI = matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
cptDefaults = c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptDefaults) = c(2,3,2)
defaults_level  <- c('1','0')
dimnames(cptDefaults)  = list('C'=defaults_level,'D'=ltv_level,'B'=dti_level)
cfit = custom.fit(net,dist=list(D = cptLTV, B = cptDTI, C = cptDefaults))
net  = model2network("[A][B][C|A:B]")
cptLTV = matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
cptDTI = matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
cptDefaults = c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptDefaults) = c(2,3,2)
defaults_level  <- c('1','0')
dimnames(cptDefaults)  = list('C'=defaults_level,'A'=ltv_level,'B'=dti_level)
cfit = custom.fit(net,dist=list(A = cptLTV, B = cptDTI, C = cptDefaults))
net  = model2network("[A][B][D|A:B]")
cptLTV = matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
cptDTI = matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
cptDefaults = c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptDefaults) = c(2,3,2)
defaults_level  <- c('1','0')
dimnames(cptDefaults)  = list('D'=defaults_level,'A'=ltv_level,'B'=dti_level)
cfit = custom.fit(net,dist=list(A = cptLTV, B = cptDTI, D = cptDefaults))
net  = model2network("[C][B][D|C:B]")
cptLTV = matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
cptDTI = matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
cptDefaults = c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptDefaults) = c(2,3,2)
defaults_level  <- c('1','0')
dimnames(cptDefaults)  = list('D'=defaults_level,'C'=ltv_level,'B'=dti_level)
cfit = custom.fit(net,dist=list(C = cptLTV, B = cptDTI, D = cptDefaults))
net  = model2network("[C][B][D|C:B]")
ltv_level <-c('<20%','20%-30%','30%-40%')
cptLTV = matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
dti_level <- c('<5%','5%-10%')
cptDTI = matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
cptDefaults = c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptDefaults) = c(2,3,2)
defaults_level  <- c('1','0')
dimnames(cptDefaults)  = list('D'=defaults_level,'C'=ltv_level,'B'=dti_level)
cfit = custom.fit(net,dist=list(C = cptLTV, B = cptDTI, D = cptDefaults))
net  = model2network("[A][B][C|A:B]")
ltv_level <-c('<20%','20%-30%','30%-40%')
cptLTV = matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
dti_level <- c('<5%','5%-10%')
cptDTI = matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
cptDefaults = c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptDefaults) = c(2,3,2)
defaults_level  <- c('1','0')
dimnames(cptDefaults)  = list('C'=defaults_level,'A'=ltv_level,'B'=dti_level)
cfit = custom.fit(net,dist=list(A = cptLTV, B = cptDTI, C = cptDefaults))
net  = model2network("[A][B][C|A:B]")
ltv_level <-c('<20%','20%-30%','30%-40%')
cptLTV = matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
dti_level <- c('<5%','5%-10%')
cptDTI = matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
cptDefaults = c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptDefaults) = c(2,3,2)
defaults_level  <- c('1','0')
dimnames(cptDefaults)  = list('C'=defaults_level,'A'=ltv_level,'B'=dti_level)
cfit = custom.fit(net,dist=list(A = cptLTV, B = cptDTI, C = cptDefaults))
net  = model2network("[C][B][D|C:B]")
ltv_level <-c('<20%','20%-30%','30%-40%')
cptLTV = matrix(c(0.4,0.3,0.3),ncol=3,dimnames=list(NULL,ltv_level))
dti_level <- c('<5%','5%-10%')
cptDTI = matrix(c(0.3,0.7),ncol=2,dimnames=list(NULL,dti_level))
cptDefaults = c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835)
dim(cptDefaults) = c(2,3,2)
defaults_level  <- c('1','0')
dimnames(cptDefaults)  = list('D'=defaults_level,'C'=ltv_level,'B'=dti_level)
cfit = custom.fit(net,dist=list(B = cptDTI,C = cptLTV, D = cptDefaults))
?custom.fit
library(bnlearn)
?custom.fit
net <- model2network("[Income_1][Inflation_1|Income_1][BoERates_1|Income_1:Inflation_1][DTI_1|Income_1:BoERates_1][LTV_1]")
custom.fit(net,dist=list(Income_1=Income_1_model,Inflation_1=Inflation_1_model,BoERates_1=BoERates_1_model,DTI_1=DTI_1_model,LTV_1=LTV_1_model))
net <- model2network("[Income_1][Inflation_1|Income_1][BoERates_1|Income_1:Inflation_1][DTI_1|Income_1:BoERates_1][LTV_1][Defaults_1|LTV_1:DTI_1]")
custom.fit(net,dist=list(Income_1=Income_1_model,Inflation_1=Inflation_1_model,BoERates_1=BoERates_1_model,DTI_1=DTI_1_model,LTV_1=LTV_1_model,Defaults_1=Defaults_1_model))
net <- model2network("[Income_1][Inflation_1|Income_1][BoERates_1|Income_1:Inflation_1][DTI_1|Income_1:BoERates_1][ALTV_1][Defaults_1|ALTV_1:DTI_1]")
custom.fit(net,dist=list(Income_1=Income_1_model,Inflation_1=Inflation_1_model,BoERates_1=BoERates_1_model,DTI_1=DTI_1_model,ALTV_1=LTV_1_model,Defaults_1=Defaults_1_model))
aaa <- list(coef = matrix(c(1.2, 2.3, 3.4, 4.5), ncol = 2,
dimnames = list(c("(Intercept)", "ltv"), NULL)),
sd = c(0.3, 0.6))
aaa
net <- model2network("[Income_1][Inflation_1|Income_1][BoERates_1|Income_1:Inflation_1][DTI_1|Income_1:BoERates_1][LTV_1]")
custom.fit(net,dist=list(Income_1=Income_1_model,Inflation_1=Inflation_1_model,BoERates_1=BoERates_1_model,DTI_1=DTI_1_model,LTV_1=LTV_1_model))
dti_level <- c('<5%','5%-10%','10%-15%','15%-20%','20%-25%','25%+')
DTI_1_model <- matrix(c(0.16,0.16,0.16,0.16,0.16,0.20,
0.13,0.14,0.15,0.16,0.18,0.24,
0.01,0.02,0.04,0.09,0.20,0.64,
0.14,0.16,0.18,0.18,0.16,0.18,
0.16,0.18,0.14,0.18,0.16,0.18,
0.18,0.18,0.16,0.18,0.16,0.14,
0.64,0.20,0.09,0.04,0.02,0.01,
0.24,0.18,0.16,0.15,0.14,0.13,
0.20,0.16,0.16,0.16,0.16,0.16))
dim(DTI_1_model) <- c(6,3,3)
dimnames(DTI_1_model) <- list('DTI_1'=dti_level,'BoERates_1'=boe_level,'Income_1'=income_level)
net <- model2network("[Income_1][Inflation_1|Income_1][BoERates_1|Income_1:Inflation_1][DTI_1|Income_1:BoERates_1][LTV_1]")
custom.fit(net,dist=list(Income_1=Income_1_model,Inflation_1=Inflation_1_model,BoERates_1=BoERates_1_model,DTI_1=DTI_1_model,LTV_1=LTV_1_model))
LTV_1_model
custom.fit(net,dist=list(Income_1=Income_1_model,Inflation_1=Inflation_1_model,BoERates_1=BoERates_1_model,DTI_1=DTI_1_model,ALTV_1=LTV_1_model,Defaults_1=Defaults_1_model))
net <- model2network("[Income_1][Inflation_1|Income_1][BoERates_1|Income_1:Inflation_1][DTI_1|Income_1:BoERates_1][ALTV_1][Defaults_1|ALTV_1:DTI_1]")
custom.fit(net,dist=list(Income_1=Income_1_model,Inflation_1=Inflation_1_model,BoERates_1=BoERates_1_model,DTI_1=DTI_1_model,ALTV_1=LTV_1_model,Defaults_1=Defaults_1_model))
net <- model2network("[Income_1][Inflation_1|Income_1][BoERates_1|Income_1:Inflation_1][DTI_1|Income_1:BoERates_1][LTV_1]")
custom.fit(net,dist=list(Income_1=Income_1_model,Inflation_1=Inflation_1_model,BoERates_1=BoERates_1_model,DTI_1=DTI_1_model,LTV_1=LTV_1_model))
Defaults_1_model <- list(coef=matrix(c(0.01,0.01,0.01,0.015,0.01,0.018,0.01,0.019,0.01,0.02,0.01,0.02),ncol=6,dimmnames=list(c("(Intercept)",'LTV_1'),NULL)),
sd=c(0.01,0.01,0.01,0.01,0.01,0.01))
matrix(c(0.01,0.01,0.01,0.015,0.01,0.018,0.01,0.019,0.01,0.02,0.01,0.02),ncol=6)
Defaults_1_model <- list(coef=matrix(c(0.01,0.01,0.01,0.015,0.01,0.018,0.01,0.019,0.01,0.02,0.01,0.02),ncol=6,dimnames=list(c("(Intercept)",'LTV_1'),NULL)),
sd=c(0.01,0.01,0.01,0.01,0.01,0.01))
LTV_1_model <- list(coef = c("(Intercept)" = 0.4813), sd = 0.2248)
net <- model2network("[Income_1][Inflation_1|Income_1][BoERates_1|Income_1:Inflation_1][DTI_1|Income_1:BoERates_1][LTV_1][Defaults_1|LTV_1:DTI_1]")
custom.fit(net,dist=list(Income_1=Income_1_model,Inflation_1=Inflation_1_model,BoERates_1=BoERates_1_model,DTI_1=DTI_1_model,LTV_1=LTV_1_model,Defaults_1=Defaults_1_model))
runApp()
runApp()
runApp()
runApp()
cgfit
xxx <- cpdist(cgfit,DTI_1=='<5%',DTI_1=='25%+')
xxx <- cpdist(cgfit,DTI_1,DTI_1=='25%+')
xxx <- cpquery(cgfit,event=(DTI_1=='<5%'),evidence=(DTI_1=='25%+'))
xxx
xxx <- cpquery(cgfit,event=(DTI_1=='25%+'),evidence=(DTI_1=='25%+'))
xxx
xxx <- cpquery(cgfit,event=(Income_1 = 2.5%),evidence=(DTI_1=='25%+'))
)
))))
''''
xxx <- cpquery(cgfit,event=(Income_1 = '2.5%'),evidence=(DTI_1=='25%+'))
xxx <- cpquery(cgfit,event=(Income_1 == '2.5%'),evidence=(DTI_1=='25%+'))
xxx
xxx
xxx <- cpquery(cgfit,event=(Income_1 == '2.5%'),evidence=(DTI_1=='25%+'))
xxx
xxx <- cpdist(cgfit,node=Income_1,evidence=(DTI_1=='25%+'))
xxx <- cpdist(cgfit,node='Income_1',evidence=('DTI_1'=='25%+'))
head(xxx)
xxx <- cpdist(cgfit,node='Income_1',evidence=(DTI_1=='25%+'))
head(xxx)
table(xxx)
xxx <- cpdist(cgfit,node='DTI_1',evidence=(DTI_1=='25%+'))
table(xxx)
runApp()
require(ggplot2)
xxx
xxx <- cpdist(cgfit,node='Income_1',evidence=(DTI_1=='25%+'))
class(xxx)
head(xxx)
ggplot(xxx,aes(x=Income_1))+geom_bar()
ggplot(xxx,aes(x=Income_1))+geom_hist()
ggplot(xxx,aes(x=Income_1))+geom_histogram()
ggplot(xxx,aes(x=Income_1))+geom_histogram(aes(y=..density..))
ggplot(xxx,aes(x=Income_1))+geom_histogram()
ggplot(xxx,aes(x=Income_1))+geom_histogram(aes(y = ..density..))
ggplot(xxx,aes(x=Income_1))+geom_histogram(aes(y = ..density..geom_density()
)
''''
ggplot(xxx,aes(x=Income_1))+geom_histogram(aes(y = ..density..))+geom_density()
runApp()
runApp()
xxx <- cpdist(cgfit,node='Income_1',evidence=(BoERates_1=='0.5%')
)
head(xxx)
table(xxx)
runApp()
runApp()
xxxx <- cpdist(cgfit,node='Income_1',evidence=(BoERates_1=='0.5%'))
head(xxxx)
evi_string <- "cpdist(cgfit,node='Income_1',evidence=(BoERates_1=='0.5%'))"
result <- eval(parse(text=eval_string))
result <- eval(parse(text=evi_string))
head(result)
table(result)
runApp()
runApp()
dim(xxxx)
head(xxxx[,1])
head(xxxx[,'Income_1'])
runApp()
head(xxx)
a <- with(xxx,get('Income_1'))
head(a)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
head(result)
xxx <- cpdist(cgfit,c(\"BoERates_1\",\"DTI_1\",\"Income_1\",\"Inflation_1\",\"LTV_1\"),(Defaults_1>0.0153&Defaults_1< 0.0198))
xxx <- cpdist(cgfit,c("BoERates_1","DTI_1","Income_1","Inflation_1","LTV_1"),(Defaults_1>0.0153&Defaults_1< 0.0198))
head(xxx)
type(xxx)
typeoff(xxx)
typeof(xxx)
class(xxx)
class(xxx[,1])
is.factor(xxx$DTI_1)
is.factor(xxx$DTI_1)
runApp()
runApp()
head(xxx)
xxx$DTI_1[1]
as.character(xxx$DTI_1[1])
as.character(xxx$DTI_1[1])
runApp()
