graphviz.plot(bn.hc)
bn.hc
score(bn.hc,data=marks,type="bic-g")
fitted = bn.fit(bn.hc,data=marks)
fitted
bn.gs
graphviz.plot(bn.gs)
dmarks = discretize(marks,breaks=2,method="interval")
head(marks)
head(dmarks)
bn.dgs=gs(dmarks)
bn.dhc=hc(dmarks)
all.equal(bn.dgs,bn.dhc)
data(learning.test)
str(learning.test)
bn.gs
graphviz.plot(bn.gs)
bn2<-iamb(learning.test)
bn3<-fast.iamb(learning.test)
bn4<-inter.iamb(learning.test)
bn.hc<-hc(learning.test,score="aic")
graphviz.plot(bn.hc)
graphviz.plot(bn.gs)
bn.hc<-hc(learning.test,score="aic")
graphviz.plot(bn.hc)
bn.AB<-gs(learning.test,blacklist=c("B","A"))
graphviz.plot(bn.AB)
graphviz.plot(bn.AB)
score(bn.AB,learning.test,type="bde")
bn.BA<-gs(learning.test,blacklist=c("A","B"))
graphviz.plot(bn.BA)
undirected.arcs(bn.gs)
graphviz.plot(bn.gs)
bn.dag<-set.arc(bn.gs,"A","B")
graphviz.plot(bn.dag)
other <- empty.graph(nodes = nodes(bn.hc))
alarm.gs<-gs(alarm)
alarm.gs
graphviz.plot(alarm.gs)
pdag = iamb(learning.test)
graphviz.plot(pdag)
dag = set.arc(pdag, from = "B", to = "A")
graphviz.plot(dag)
fit = bn.fit(dag, learning.test)
fit
fit$C
bn.fit.barchart(fit$A)
bn.fit.dotplot(fit$D)
data(gaussian.test)
pdag = iamb(gaussian.test)
graphviz.plot(pdag)
undirected.arcs(pdag)
dag = set.arc(pdag,"D","B")
graphviz.plot(dag)
fit = bn.fit(dag,gaussian.test)
head(gaussian.test)
fit
coefficients(fit$F)
bn.fit.qqplot(fit)
bn.fit.xyplot(fit)
bn.fit.histogram(fit)
pdag = iamb(learning.test)
dag = set.arc(pdag,from="A",to="B")
fit = bn.fit(dag,learning.test,method="bayes")
fit
head(gaussina.test)
head(gaussian.test)
?break
?cut
gaussian.test$G_bin<-cut(gaussian.test$G,4)
head(gaussian.test)
gt<-gaussian.test
gt[,-c("G")]
gt[,-7]
head(gt[,-7])
gt<-gt[,-7]
pdag<-iamb(gt)
graphviz.plot(pdag)
dag = set.arc(pdag,"D","B")
fit = bn.fit(dag,gaussian.test)
fit = bn.fit(dag,gt)
plot(dag)
bn.fit(dag,gt)
dag
pdag<-hc(gt)
plot(pdag)
bn.fit(pdag,gt)
?bn.fit
str(gt)
?custom.fit
data(learning.test)
head(learning.test)
res = gs(learning.test)
plot(res)
res = set.arc(res,"A","B")
fitted = bn.fit(res,learning.test)
fitted
bn.fit.barchart(fitted$A)
bn.fit.barchart(fitted$B)
fitted$A
fitted$B
new.cpt=matrix(c(0.1,0.2,0.3,0.2,0.5,0.6,0.7,0.3,0.1),byrow=TRUE,ncol=3,dimnames=list(B=c("a","b","c"),A=c("a","b","c")))
new.cpt
fitted$B<-as.table(new.cpt)
all.equal(res,bn.net(fitted))
res=hc(gaussian.test)
fitted = bn.fit(res,gaussian.test)
res
head(gaussian.test)
require(Rgraphviz)
require(bnlearn)
data(learning.test)
head(learning.test)
res = gs(learning.test)
plot(res)
res = set.arc(res,"A","B")
fitted = bn.fit(res,learning.test)
fitted$B
new.cpt = matrix(c(0.1, 0.2, 0.3, 0.2, 0.5, 0.6, 0.7, 0.3, 0.1),
byrow = TRUE, ncol = 3,
dimnames = list(B = c("a", "b", "c"), A = c("a", "b", "c")))
fitted$B=as.table(new.cpt)
fitted$B
all.equal(res,bn.net(fitted))
res = hc(gaussian.test)
fitted = bn.fit(res,gaussian.test)
fitted$F
head(gaussian.test)
fitted
plot(res)
res = gs(learning.test)
plot(res)
res = set.arc(res,"A","B")
plot(res)
fitted = bn.fit(res,learning.test)
fitted$B
fitted$F
res = hc(gaussian.test)
fitted = bn.fit(res,gaussian.test)
fitted$F = list(coef)
fitted$F = list(coef=c(1,2,3,4,5),sd=3)
fitted$F = lm(F~A+D+E+G,data=gaussian.test)
net = model2network("[A][B][C|A:B]")
cptA = matrix(c(0.4,0.6),ncol=2,dimnames=list(NULL,c("LOW","HIGH")))
cptB = matrix(c(0.8,0.2),ncol=2,dimnames=list(NULL,c("GOOD","BAD")))
cptC = c(0.5,0.5,0.4,0.6,0.3,0.7,0.2,0.8)
dim(cptC)=c(2,2,2)
dimnames(cptC)=list("C"=c("TRUE","FALSE"),"A"=c("LOW","HIGH"),"B"=c("GOOD","BAD"))
cfit=custom.fit(net,dist=list(A=cptA,B=cptB,C=cptC))
cfit
cfit=custom.fit(net,dist=list(A=cptA,B=cptB,C=cptC),ordinal=c("A","B"))
distA=list(coef=c("Intercept"=2),sd=1)
cfit=custom.fit(net,dist=list(A=distA,B=cptB,C=cptC),ordinal=c("A","B"))
distB=list(coef=c("Intercept"=1),sd=0.5)
distC=list(coef=c("Intercept"=0.5,"A"=0.75,"B"=1.32),sd=0.4)
cfit=custom.fit(net,dist=list(A=distA,B=distB,C=distC))
distA = list(coef = c("(Intercept)" = 2), sd = 1)
distB = list(coef = c("(Intercept)" = 1), sd = 1.5)
distC = list(coef = c("(Intercept)" = 0.5, "A" = 0.75, "B" = 1.32), sd = 0.4)
cfit = custom.fit(net, dist = list(A = distA, B = distB, C = distC))
cfit
cptA = matrix(c(0.4,0.6),ncol=2,dimnames=list(NULL,c("LOW","HIGH")))
distB = list(coef=c("(Intercept)"=1),sd=1.5)
distC=list(coef=matrix(c(1.2,2.3,3.4,4.5),ncol=2,dimnames=list(c("Intercept","B"),NULL)),sd=c(0.3,0.6))
distB
distC
cfit=custom.fit(net,dist=list(A=distA,B=distB,c=distC))
cfit=custom.fit(net,dist=list(A=distA,B=distB,C=distC))
cptA = matrix(c(0.4, 0.6), ncol = 2, dimnames = list(NULL, c("LOW", "HIGH")))
distB = list(coef = c("(Intercept)" = 1), sd = 1.5)
distC = list(coef = matrix(c(1.2, 2.3, 3.4, 4.5), ncol = 2,
dimnames = list(c("(Intercept)", "B"), NULL)),
sd = c(0.3, 0.6))
distC
cgfit = custom.fit(net, dist = list(A = cptA, B = distB, C = distC))
cgfit
cgfit
cpquery(net.data, (A=="LOW"), TRUE)
cpquery(cgfit, (A=="LOW"), TRUE)
cpquery(cgfit, (A=="HIGH"), TRUE)
cpquery(cgfit, (B==0), TRUE)
cpquery(cgfit, (B==2), TRUE)
?cpquery
cpdist(cgfit, (B==2), TRUE)
cpdist(cgfit, "B",(A=="LOW"))
distB
b<-cpdist(cgfit, "B",(A=="LOW"))
str(b)
head(b)
mean(b$B)
sd(b$B)
distC
c<-cpdist(cgfit, "C",(A=="LOW",B==0.9))
c<-cpdist(cgfit, "C",(A=="LOW",B=0.9))
c<-cpdist(cgfit, "C",c(A=="LOW",B==0.9))
c<-cpdist(cgfit, "C",(A=="LOW")&(B==0.9))
c
c<-cpdist(cgfit, "C",(A=="LOW")&((B>=0.9)&(B<=1.2)))
c
distC
c<-cpdist(cgfit, "C",(A=="LOW")&((B>=0.9)&(B<=1.1)))
c
distC
mean(c$C)
sd(c$C)
a<-cpdist(cgfit, "A",(B>=0.9)&(B<=1.1)&((C>=3.2)&(C<=3.8)))
a
table(a)
cpquery(cgfit, "A",(B>=0.9)&(B<=1.1)&((C>=3.2)&(C<=3.8)))
b1<-cpdist(cgfit, "B",(A=="LOW")&((C>=3.2)&(C<=3.8)))
b1
mean(b1$B)
sd(b1$B)
install.packages('knitr')
install.packages('Packrat')
install.packages('packrat')
mtcars %>% ggvis(x = ~wt) %>% layer_histograms(width = 1)
library(dplyr)
mtcars %>% ggvis(x = ~wt) %>% layer_histograms(width = 1)
library(ggvis)
mtcars %>% ggvis(x = ~wt) %>% layer_histograms(width = 1)
setwd('C:\\Projects\\BayesianNetwork\\Netscene')
library(shiny)
runApp()
library(bnlearn)
set.seed(42)
yn <- c("yes", "no")
cptA <- matrix(c(0.01, 0.99), ncol=2, dimnames=list(NULL, yn))
cptA
Income_1_model <- matrix(c(0.1,0.8,0.1),ncol=3,dimnames=list(NULL,income_level))
income_level <- c('LOW','MIDDLE','HIGH')
Income_1_model <- matrix(c(0.1,0.8,0.1),ncol=3,dimnames=list(NULL,income_level))
Income_1_model
cptT <- matrix(c(0.05, 0.95, 0.01, 0.99),
ncol=2, dimnames=list("T"=yn, "A"=yn))
cptT
three_level <- c('LOW','MIDDLE','HIGH')
Income_1_model <- matrix(c(0.1,0.8,0.1),ncol=3,dimnames=list(NULL,income_level))
Inflation_1_model <- matrix(c(0.9,0.09,0.01,0.1,0.6,0.3,0.01,0.3,0.69),ncol=4,dimnames=list('Inflation_1'=three_level,'Income_1'=three_level))
matrix(c(0.9,0.09,0.01,0.1,0.6,0.3,0.01,0.3,0.69),ncol=4)
matrix(c(0.9,0.09,0.01,0.1,0.6,0.3,0.01,0.3,0.69),ncol=3)
matrix(c(0.9,0.09,0.01,0.1,0.6,0.3,0.01,0.3,0.69),ncol=3,dimnames=list('Inflation_1'=three_level,'Income_1'=three_level))
matrix(c(0.9,0.09,0.01,0.1,0.6,0.3,0.01,0.3,0.69),ncol=3,dimnames=list('Inflation_1'=three_level,'Income_1'=three_level))
BoERates_1_model <- c(0.99,0.005,0.005,0.9,0.09,0.01,0.8,0.19,0.01,0.99,0.005,0.005,0.6,0.39,0.01,0.2,0.6,0.2,0.9,0.09,0.01,0.2,0.7,0.1,0.01,0.4,0.59)
length(BoERates_1_model)
dim(BoERates_1_model) <- c(3,3,3)
dimnames(BoERates_1_model) <- list('Inflation_1'=c('<1.5%','1.5%-2.5%','>2.5%'),'Income_1'=c('0','2.5%','5%'),'BoERates_1'=c('0.5%','1.5%','2.5%'))
BoERates_1_model
BoERates_1_model <- c(0.99,0.005,0.005,0.9,0.09,0.01,0.8,0.19,0.01,0.99,0.005,0.005,0.6,0.39,0.01,0.2,0.6,0.2,0.9,0.09,0.01,0.2,0.7,0.1,0.01,0.4,0.59)
dim(BoERates_1_model) <- c(3,3,3)
dimnames(BoERates_1_model) <- list('BoERates_1'=c('0.5%','1.5%','2.5%'),'Income_1'=c('0','2.5%','5%'),'Inflation_1'=c('<1.5%','1.5%-2.5%','>2.5%'))
BoERates_1_model
Spread_1_model <- matrix(c(1,0),ncol=2,dimnames=list('Spread_1'=spread_level))
spread_level <- c('1%','!=1%')
Spread_1_model <- matrix(c(1,0),ncol=2,dimnames=list('Spread_1'=spread_level))
Spread_1_model <- matrix(c(1,0),ncol=2,dimnames=list(NULL,'Spread_1'=spread_level))
Spread_1_model
100/8
?runif
a <- runif(10,0,1)
a
a/sum(a)
a <- runif(8,0,1)
a/sum(a)
ltv_level <-c('<20%','20%-30%','30%-40%','40%-50%','50%-60%','60%-70%','70%-75%','75%+')
LTV_1_model <- matrix(c(0.02,0.05,0.09,0.14,0.19,0.2,0.19,0.12),ncol=8,dimnames=list(NULL,'LTV_1'=ltv_level)
)
LTV_1_model
Defaults_1_model <- matrix(c(0.001,0.999,0.0088,0.9912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835,0.00222,0.99778,0.00261,0.99739,
0.00112,0.99888,0.00110,0.9989,0.00130,0.9987,0.00132,0.99868,0.00186,0.99814,0.00204,0.99796,0.00236,0.99764,0.00302,0.99698,
0.00115,0.99885,0.00130,0.9987,0.00132,0.99868,0.00162,0.99838,0.00224,0.99776,0.00249,0.99751,0.00311,0.99689,0.00399,0.99601,
0.00136,0.99864,0.00162,0.99838,0.00169,0.99831,0.00167,0.99833,0.00254,0.99746,0.00278,0.99722,0.00369,0.99631,0.00384,0.99616,
0.00133,0.99867,0.00188,0.99812,0.00195,0.99805,0.00181,0.99819,0.00259,0.99741,0.00288,0.99712,0.00393,0.99607,0.00466,0.99534,
0.00179,0.99821,0.00176,0.99824,0.00175,0.99825,0.00181,0.99819,0.00281,0.99719,0.00307,0.99693,0.00386,0.99614,0.00403,0.99597))
Defaults_1_model
dim(Defaults_1_model) <- c(2,8,6)
Defaults_1_model
typeof(Defaults_1_model)
class(Defaults_1_model)
sum(Defaults_1_model)
dimnames(Defaults_1_model) <- list('Default_1'=c('Bad','Good'),'LTV_1'=ltv_level,'DTI_1'=dti_level)
dti_level <- c('<5%','5%-10%','10%-15%','15%-20%','20%-25%','25%+')
default_level <- c('Bad','Good')
dimnames(Defaults_1_model) <- list('Default_1'=c('Bad','Good'),'LTV_1'=ltv_level,'DTI_1'=dti_level)
Defaults_1_model
2*3*3*8*6
100/6
13+14+15+16+18
1+2+4+7+20
14+16+18+18+16+18
dti_level <- c('<5%','5%-10%','10%-15%','15%-20%','20%-25%','25%+')
DTI_1_model <- matrix(c(0.16,0.16,0.16,0.16,0.16,0.20,
0.13,0.14,0.15,0.16,0.18,0.24,
0.01,0.02,0.04,0.07,0.20,0.64,
0.14,1.16,0.18,0.18,0.16,0.18,
0.16,0.18,0.14,0.18,0.16,0.18,
0.18,0.18,0.16,0.18,0.16,0.14,
0.64,0.20,0.07,0.04,0.02,0.01,
0.24,0.18,0.16,0.15,0.14,0.13,
0.20,0.16,0.16,0.16,0.16,0.16))
dim(DTI_1_model) <- c(6,3,3)
dimnames(DTI_1_model) <- list('DTI_1'=dti_level,'BoERates_1'=boe_level,'Income_1'=income_level)
income_level <- c('0','2.5%','5%')
inflation_level <- c('<1.5%','1.5%-2.5%','>2.5%')
boe_level <- c('0.5%','1.5%','2.5%')
spread_level <- c('1%','!=1%')
dti_level <- c('<5%','5%-10%','10%-15%','15%-20%','20%-25%','25%+')
DTI_1_model <- matrix(c(0.16,0.16,0.16,0.16,0.16,0.20,
0.13,0.14,0.15,0.16,0.18,0.24,
0.01,0.02,0.04,0.07,0.20,0.64,
0.14,1.16,0.18,0.18,0.16,0.18,
0.16,0.18,0.14,0.18,0.16,0.18,
0.18,0.18,0.16,0.18,0.16,0.14,
0.64,0.20,0.07,0.04,0.02,0.01,
0.24,0.18,0.16,0.15,0.14,0.13,
0.20,0.16,0.16,0.16,0.16,0.16))
dim(DTI_1_model) <- c(6,3,3)
dimnames(DTI_1_model) <- list('DTI_1'=dti_level,'BoERates_1'=boe_level,'Income_1'=income_level)
DTI_1_model
runApp()
setwd("C:\\Projects\\BayesianNetwork\\Netscene")
require(bnlearn)
require(Rgraphviz)
require(vcd)
require(ggplot2)
require(stringr)
require(reshape)
#include the definition of the class nodes
source("C:\\Projects\\BayesianNetwork\\Netscene\\GraphRiskNode_class_z.R")
###Convert the vec to a list with name is the value of vec and element of list is also value of list
### input: vec = c("a","b")
### output:$a    $b
###        [1] a [2] b
namel<-function (vec){
tmp<-as.list(vec)
names(tmp)<-as.character(unlist(vec))
tmp
}
pn<-{}
nodes<-{}
#yn   <- c(0,1)
#decl <- seq(0.1,1.1,1)
#dech <- seq(0.1,1.1,1)
EEselNode<-1
evi_list <- list() ## should be ok if i replace << with <
result_bin<-list()
income_level <- c('0','2.5%','5%')
inflation_level <- c('<1.5%','1.5%-2.5%','>2.5%')
boe_level <- c('0.5%','1.5%','2.5%')
spread_level <- c('1%','!=1%')
Income_1_model <- matrix(c(0.1,0.8,0.1),ncol=3,dimnames=list(NULL,'Income_1'=income_level))
Inflation_1_model <- matrix(c(0.9,0.09,0.01,0.1,0.6,0.3,0.01,0.3,0.69),ncol=3,dimnames=list('Inflation_1'=inflation_level,'Income_1'=income_level))
BoERates_1_model <- c(0.99,0.005,0.005,0.9,0.09,0.01,0.8,0.19,0.01,0.99,0.005,0.005,0.6,0.39,0.01,0.2,0.6,0.2,0.9,0.09,0.01,0.2,0.7,0.1,0.01,0.4,0.59)
dim(BoERates_1_model) <- c(3,3,3)
dimnames(BoERates_1_model) <- list('BoERates_1'=boe_level,'Income_1'=income_level,'Inflation_1'=inflation_level)
Spread_1_model <- matrix(c(1,0),ncol=2,dimnames=list(NULL,'Spread_1'=spread_level))
#the below is make up number
ltv_level <-c('<20%','20%-30%','30%-40%','40%-50%','50%-60%','60%-70%','70%-75%','75%+')
LTV_1_model <- matrix(c(0.02,0.05,0.09,0.14,0.19,0.2,0.19,0.12),ncol=8,dimnames=list(NULL,'LTV_1'=ltv_level))
dti_level <- c('<5%','5%-10%','10%-15%','15%-20%','20%-25%','25%+')
DTI_1_model <- matrix(c(0.16,0.16,0.16,0.16,0.16,0.20,
0.13,0.14,0.15,0.16,0.18,0.24,
0.01,0.02,0.04,0.07,0.20,0.64,
0.14,1.16,0.18,0.18,0.16,0.18,
0.16,0.18,0.14,0.18,0.16,0.18,
0.18,0.18,0.16,0.18,0.16,0.14,
0.64,0.20,0.07,0.04,0.02,0.01,
0.24,0.18,0.16,0.15,0.14,0.13,
0.20,0.16,0.16,0.16,0.16,0.16))
dim(DTI_1_model) <- c(6,3,3)
dimnames(DTI_1_model) <- list('DTI_1'=dti_level,'BoERates_1'=boe_level,'Income_1'=income_level)
Income_1_model
Inflation_1_model
BoERates_1_model
default_level <- c('Bad','Good')
Defaults_1_model <- matrix(c(0.001,0.999,0.0088,0.9912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835,0.00222,0.99778,0.00261,0.99739,
0.00112,0.99888,0.00110,0.9989,0.00130,0.9987,0.00132,0.99868,0.00186,0.99814,0.00204,0.99796,0.00236,0.99764,0.00302,0.99698,
0.00115,0.99885,0.00130,0.9987,0.00132,0.99868,0.00162,0.99838,0.00224,0.99776,0.00249,0.99751,0.00311,0.99689,0.00399,0.99601,
0.00136,0.99864,0.00162,0.99838,0.00169,0.99831,0.00167,0.99833,0.00254,0.99746,0.00278,0.99722,0.00369,0.99631,0.00384,0.99616,
0.00133,0.99867,0.00188,0.99812,0.00195,0.99805,0.00181,0.99819,0.00259,0.99741,0.00288,0.99712,0.00393,0.99607,0.00466,0.99534,
0.00179,0.99821,0.00176,0.99824,0.00175,0.99825,0.00181,0.99819,0.00281,0.99719,0.00307,0.99693,0.00386,0.99614,0.00403,0.99597))
dim(Defaults_1_model) <- c(2,8,6)
dimnames(Defaults_1_model) <- list('Default_1'=c('Bad','Good'),'LTV_1'=ltv_level,'DTI_1'=dti_level)
Defaults_1_model
Income_1 <- new("GRNode_d",name="Income_1",model=list(model=Income_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
Inflation_1 <- new("GRNode_d",name="Inflation_1",model=list(model=Inflation_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
BoERates_1 <- new("GRNode_d",name="BoERates_1",model=list(model=BoERates_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
DTI_1 <- new("GRNode_d",name="DTI_1",model=list(model=DTI_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
LTV_1 <- new("GRNode_d",name="LTV_1",model=list(model=LTV_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
Spread_1 <- new("GRNode_d",name="Spread_1",model=list(model=Spread_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
Defaults_1 <- new("GRNode_d",name="Defaults_1",model=list(model=Defaults_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
networkstring <- "[LTV_1][Income_1][Inflation_1|Income_1][BoERates_1|Inflation_1:Income_1][DTI_1|Income_1:BoERates_1][Defaults_1|DTI_1:LTV_1]"
net <- model2network(networkstring)
nnodes <- list(Income_1,Inflation_1,BoERates_1,DTI_1,LTV_1,Defaults_1)
cgfit <- fit.net.z(nnodes,net)
DTI_1_model
income_level <- c('0','2.5%','5%')
inflation_level <- c('<1.5%','1.5%-2.5%','>2.5%')
boe_level <- c('0.5%','1.5%','2.5%')
spread_level <- c('1%','!=1%')
Income_1_model <- matrix(c(0.1,0.8,0.1),ncol=3,dimnames=list(NULL,'Income_1'=income_level))
Inflation_1_model <- matrix(c(0.9,0.09,0.01,0.1,0.6,0.3,0.01,0.3,0.69),ncol=3,dimnames=list('Inflation_1'=inflation_level,'Income_1'=income_level))
BoERates_1_model <- c(0.99,0.005,0.005,0.9,0.09,0.01,0.8,0.19,0.01,0.99,0.005,0.005,0.6,0.39,0.01,0.2,0.6,0.2,0.9,0.09,0.01,0.2,0.7,0.1,0.01,0.4,0.59)
dim(BoERates_1_model) <- c(3,3,3)
dimnames(BoERates_1_model) <- list('BoERates_1'=boe_level,'Income_1'=income_level,'Inflation_1'=inflation_level)
Spread_1_model <- matrix(c(1,0),ncol=2,dimnames=list(NULL,'Spread_1'=spread_level))
#the below is make up number
ltv_level <-c('<20%','20%-30%','30%-40%','40%-50%','50%-60%','60%-70%','70%-75%','75%+')
LTV_1_model <- matrix(c(0.02,0.05,0.09,0.14,0.19,0.2,0.19,0.12),ncol=8,dimnames=list(NULL,'LTV_1'=ltv_level))
dti_level <- c('<5%','5%-10%','10%-15%','15%-20%','20%-25%','25%+')
DTI_1_model <- matrix(c(0.16,0.16,0.16,0.16,0.16,0.20,
0.13,0.14,0.15,0.16,0.18,0.24,
0.01,0.02,0.04,0.09,0.20,0.64,
0.14,1.16,0.18,0.18,0.16,0.18,
0.16,0.18,0.14,0.18,0.16,0.18,
0.18,0.18,0.16,0.18,0.16,0.14,
0.64,0.20,0.09,0.04,0.02,0.01,
0.24,0.18,0.16,0.15,0.14,0.13,
0.20,0.16,0.16,0.16,0.16,0.16))
dim(DTI_1_model) <- c(6,3,3)
dimnames(DTI_1_model) <- list('DTI_1'=dti_level,'BoERates_1'=boe_level,'Income_1'=income_level)
##########
default_level <- c('Bad','Good')
Defaults_1_model <- matrix(c(0.001,0.999,0.0088,0.9912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835,0.00222,0.99778,0.00261,0.99739,
0.00112,0.99888,0.00110,0.9989,0.00130,0.9987,0.00132,0.99868,0.00186,0.99814,0.00204,0.99796,0.00236,0.99764,0.00302,0.99698,
0.00115,0.99885,0.00130,0.9987,0.00132,0.99868,0.00162,0.99838,0.00224,0.99776,0.00249,0.99751,0.00311,0.99689,0.00399,0.99601,
0.00136,0.99864,0.00162,0.99838,0.00169,0.99831,0.00167,0.99833,0.00254,0.99746,0.00278,0.99722,0.00369,0.99631,0.00384,0.99616,
0.00133,0.99867,0.00188,0.99812,0.00195,0.99805,0.00181,0.99819,0.00259,0.99741,0.00288,0.99712,0.00393,0.99607,0.00466,0.99534,
0.00179,0.99821,0.00176,0.99824,0.00175,0.99825,0.00181,0.99819,0.00281,0.99719,0.00307,0.99693,0.00386,0.99614,0.00403,0.99597))
dim(Defaults_1_model) <- c(2,8,6)
dimnames(Defaults_1_model) <- list('Default_1'=c('Bad','Good'),'LTV_1'=ltv_level,'DTI_1'=dti_level)
Income_1 <- new("GRNode_d",name="Income_1",model=list(model=Income_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
Inflation_1 <- new("GRNode_d",name="Inflation_1",model=list(model=Inflation_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
BoERates_1 <- new("GRNode_d",name="BoERates_1",model=list(model=BoERates_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
DTI_1 <- new("GRNode_d",name="DTI_1",model=list(model=DTI_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
LTV_1 <- new("GRNode_d",name="LTV_1",model=list(model=LTV_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
Spread_1 <- new("GRNode_d",name="Spread_1",model=list(model=Spread_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
Defaults_1 <- new("GRNode_d",name="Defaults_1",model=list(model=Defaults_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
networkstring <- "[LTV_1][Income_1][Inflation_1|Income_1][BoERates_1|Inflation_1:Income_1][DTI_1|Income_1:BoERates_1][Defaults_1|DTI_1:LTV_1]"
net <- model2network(networkstring)
nnodes <- list(Income_1,Inflation_1,BoERates_1,DTI_1,Spread_1,LTV_1,Defaults_1)
nnodes <- list(Income_1,Inflation_1,BoERates_1,DTI_1,LTV_1,Defaults_1)
cgfit <- fit.net.z(nnodes,net)
DTI_1_model
cptD
yn <- c("yes", "no")
cptE <- c(1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0)
dim(cptE) <- c(2, 2, 2)
dimnames(cptE) <- list("E"=yn, "L"=yn, "T"=yn)
cptE
cptD <- c(0.9, 0.1, 0.7, 0.3, 0.8, 0.2, 0.1, 0.9)
dim(cptD) <- c(2, 2, 2)
dimnames(cptD) <- list("D"=yn, "E"=yn, "B"=yn)
cptD
DTI_1_model <- matrix(c(0.16,0.16,0.16,0.16,0.16,0.20,
0.13,0.14,0.15,0.16,0.18,0.24,
0.01,0.02,0.04,0.09,0.20,0.64,
0.14,1.16,0.18,0.18,0.16,0.18,
0.16,0.18,0.14,0.18,0.16,0.18,
0.18,0.18,0.16,0.18,0.16,0.14,
0.64,0.20,0.09,0.04,0.02,0.01,
0.24,0.18,0.16,0.15,0.14,0.13,
0.20,0.16,0.16,0.16,0.16,0.16))
sum(DTI_1_model)
sum(c(0.16,0.16,0.16,0.16,0.16,0.20))
sum(c( 0.13,0.14,0.15,0.16,0.18,0.24))
sum(c(0.01,0.02,0.04,0.09,0.20,0.6))
sum(c(0.01,0.02,0.04,0.09,0.20,0.64))
sum(c(0.14,1.16,0.18,0.18,0.16,0.18))
income_level <- c('0','2.5%','5%')
inflation_level <- c('<1.5%','1.5%-2.5%','>2.5%')
boe_level <- c('0.5%','1.5%','2.5%')
spread_level <- c('1%','!=1%')
Income_1_model <- matrix(c(0.1,0.8,0.1),ncol=3,dimnames=list(NULL,'Income_1'=income_level))
Inflation_1_model <- matrix(c(0.9,0.09,0.01,0.1,0.6,0.3,0.01,0.3,0.69),ncol=3,dimnames=list('Inflation_1'=inflation_level,'Income_1'=income_level))
BoERates_1_model <- c(0.99,0.005,0.005,0.9,0.09,0.01,0.8,0.19,0.01,0.99,0.005,0.005,0.6,0.39,0.01,0.2,0.6,0.2,0.9,0.09,0.01,0.2,0.7,0.1,0.01,0.4,0.59)
dim(BoERates_1_model) <- c(3,3,3)
dimnames(BoERates_1_model) <- list('BoERates_1'=boe_level,'Income_1'=income_level,'Inflation_1'=inflation_level)
Spread_1_model <- matrix(c(1,0),ncol=2,dimnames=list(NULL,'Spread_1'=spread_level))
#the below is make up number
ltv_level <-c('<20%','20%-30%','30%-40%','40%-50%','50%-60%','60%-70%','70%-75%','75%+')
LTV_1_model <- matrix(c(0.02,0.05,0.09,0.14,0.19,0.2,0.19,0.12),ncol=8,dimnames=list(NULL,'LTV_1'=ltv_level))
dti_level <- c('<5%','5%-10%','10%-15%','15%-20%','20%-25%','25%+')
DTI_1_model <- matrix(c(0.16,0.16,0.16,0.16,0.16,0.20,
0.13,0.14,0.15,0.16,0.18,0.24,
0.01,0.02,0.04,0.09,0.20,0.64,
0.14,0.16,0.18,0.18,0.16,0.18,
0.16,0.18,0.14,0.18,0.16,0.18,
0.18,0.18,0.16,0.18,0.16,0.14,
0.64,0.20,0.09,0.04,0.02,0.01,
0.24,0.18,0.16,0.15,0.14,0.13,
0.20,0.16,0.16,0.16,0.16,0.16))
dim(DTI_1_model) <- c(6,3,3)
dimnames(DTI_1_model) <- list('DTI_1'=dti_level,'BoERates_1'=boe_level,'Income_1'=income_level)
default_level <- c('Bad','Good')
Defaults_1_model <- matrix(c(0.001,0.999,0.0088,0.9912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835,0.00222,0.99778,0.00261,0.99739,
0.00112,0.99888,0.00110,0.9989,0.00130,0.9987,0.00132,0.99868,0.00186,0.99814,0.00204,0.99796,0.00236,0.99764,0.00302,0.99698,
0.00115,0.99885,0.00130,0.9987,0.00132,0.99868,0.00162,0.99838,0.00224,0.99776,0.00249,0.99751,0.00311,0.99689,0.00399,0.99601,
0.00136,0.99864,0.00162,0.99838,0.00169,0.99831,0.00167,0.99833,0.00254,0.99746,0.00278,0.99722,0.00369,0.99631,0.00384,0.99616,
0.00133,0.99867,0.00188,0.99812,0.00195,0.99805,0.00181,0.99819,0.00259,0.99741,0.00288,0.99712,0.00393,0.99607,0.00466,0.99534,
0.00179,0.99821,0.00176,0.99824,0.00175,0.99825,0.00181,0.99819,0.00281,0.99719,0.00307,0.99693,0.00386,0.99614,0.00403,0.99597))
dim(Defaults_1_model) <- c(2,8,6)
dimnames(Defaults_1_model) <- list('Default_1'=c('Bad','Good'),'LTV_1'=ltv_level,'DTI_1'=dti_level)
Income_1 <- new("GRNode_d",name="Income_1",model=list(model=Income_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
Inflation_1 <- new("GRNode_d",name="Inflation_1",model=list(model=Inflation_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
BoERates_1 <- new("GRNode_d",name="BoERates_1",model=list(model=BoERates_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
DTI_1 <- new("GRNode_d",name="DTI_1",model=list(model=DTI_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
LTV_1 <- new("GRNode_d",name="LTV_1",model=list(model=LTV_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
Spread_1 <- new("GRNode_d",name="Spread_1",model=list(model=Spread_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
Defaults_1 <- new("GRNode_d",name="Defaults_1",model=list(model=Defaults_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
cgfit <- fit.net.z(nnodes,net)
DTI_1_model
