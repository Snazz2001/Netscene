})
setMethod(f="setValues",
signature="GRNode_c",
definition=function(the_obj,values){
the_obj@values <- values
return(the_obj)
})
setMethod(f="setValues",
signature="GRNode_d",
definition=function(the_obj,values){
the_obj@values <- values
return(the_obj)
})
setGeneric("getValues",function(the_obj){
standardGeneric("getValues")
})
setMethod(f="getValues",
signature="GRNode_c",
definition=function(the_obj){
return(the_obj@values)
})
setMethod(f="getValues",
signature="GRNode_d",
definition=function(the_obj){
return(the_obj@values)
})
setGeneric("setName",function(the_obj,name){
standardGeneric("setName")
})
setMethod(f="setName",
signature="GRNode_c",
definition=function(the_obj,name){
the_obj@name <- name
return(the_obj)
})
setMethod(f="setName",
signature="GRNode_d",
definition=function(the_obj,name){
the_obj@name <- name
return(the_obj)
})
setGeneric("getName",function(the_obj){
standardGeneric("getName")
})
setMethod(f="getName",
signature="GRNode_c",
definition=function(the_obj){
return(the_obj@name)
})
setMethod(f="getName",
signature="GRNode_d",
definition=function(the_obj){
return(the_obj@name)
})
setGeneric("getModel",function(the_obj){
standardGeneric("getModel")
})
setMethod(f="getModel",
signature="GRNode_c",
definition=function(the_obj){
return(the_obj@model)
})
setMethod(f="getModel",
signature="GRNode_d",
definition=function(the_obj){
return(the_obj@model)
})
setGeneric("setModel",function(the_obj,model){
standardGeneric("setModel")
})
setMethod(f="setModel",
signature="GRNode_c",
definition=function(the_obj,model){
the_obj@model <- model
return(the_obj)
})
setMethod(f="setModel",
signature="GRNode_d",
definition=function(the_obj,model){
the_obj@model <- model
return(the_obj)
})
income_level <- c('0%','2.5%','5%')
inflation_level <- c('<1.5%','1.5%-2.5%','>2.5%')
boe_level <- c('0.5%','1.5%','2.5%')
spread_level <- c('1%','2%')#new add
hpi_level <- c('-10%','0%','10%')#5% 20% 75% LTV->44% 48% 55%
Income_1_model <- matrix(c(0.1,0.8,0.1),ncol=3,dimnames=list(NULL,'Income_1'=income_level))
#Inflation_1_model <- matrix(c(0.9,0.09,0.01,0.1,0.6,0.3,0.01,0.3,0.69),ncol=3,dimnames=list('Inflation_1'=inflation_level,'Income_1'=income_level))
Inflation_1_model <- matrix(c(0.5,0.4,0.1,0.2,0.4,0.4,0.01,0.39,0.6),ncol=3,dimnames=list('Inflation_1'=inflation_level,'Income_1'=income_level))
HPI_1_model <- matrix(c(0.05,0.20,0.75),ncol=3,dimnames=list(NULL,'HPI_1'=hpi_level))
#HPI_1_model <- matrix(c(0.000,0.20,0.80),ncol=3,dimnames=list(NULL,'HPI_1'=hpi_level))
#BoERates_1_model <- c(0.99,0.005,0.005,0.9,0.09,0.01,0.8,0.19,0.01,0.99,0.005,0.005,0.6,0.39,0.01,0.2,0.6,0.2,0.9,0.09,0.01,0.2,0.7,0.1,0.01,0.4,0.59)
BoERates_1_model <- c(0.82,0.18,0.00,0.62,0.37,0.01,0.36,0.59,0.05,0.36,0.59,0.05,0.16,0.69,0.15,0.05,0.59,0.36,0.05,0.59,0.36,0.01,0.37,0.62,0.00,0.18,0.82)
dim(BoERates_1_model) <- c(3,3,3)
dimnames(BoERates_1_model) <- list('BoERates_1'=boe_level,'Income_1'=income_level,'Inflation_1'=inflation_level)
Spread_1_model <- matrix(c(0.65,0.35),ncol=2,dimnames=list(NULL,'Spread_1'=spread_level))#new add
#LTV_1_model <- list(coef = c("(Intercept)" = 0.4813), sd = 0.2248)
LTV_1_model <- list(coef = matrix(c(0.66,1,0.6,1,0.54,1),ncol=3,dimnames=list(c("(Intercept)","HPI_1"),NULL)), sd = c(0.2,0.2,0.2))
#the below is make up number
ltv_level <-c('<20%','20%-30%','30%-40%','40%-50%','50%-60%','60%-70%','70%-75%','75%+')
#LTV_1_model <- matrix(c(0.02,0.05,0.09,0.14,0.19,0.2,0.19,0.12),ncol=8,dimnames=list(NULL,'LTV_1'=ltv_level))
dti_level <- c('<5%','5%-10%','10%-15%','15%-20%','20%-25%','25%+')
#DTI_1_model <- matrix(c(0.16,0.16,0.16,0.16,0.16,0.20,
#    					0.13,0.14,0.15,0.16,0.18,0.24,
#						0.01,0.02,0.04,0.09,0.20,0.64,
#						0.14,0.16,0.18,0.18,0.16,0.18,
#						0.16,0.18,0.14,0.18,0.16,0.18,
#						0.18,0.18,0.16,0.18,0.16,0.14,
#						0.64,0.20,0.09,0.04,0.02,0.01,
#						0.24,0.18,0.16,0.15,0.14,0.13,
#						0.20,0.16,0.16,0.16,0.16,0.16))
DTI_1_model <- matrix(c(0.10934005,0.212965337,0.26596152,0.212965337,0.10934005,0.089427706,
0.007597324,0.035993978,0.10934005,0.212965337,0.26596152,0.368141791,
0.000089220,0.001028186,0.007597324,0.035993978,0.10934005,0.845951242,
0.114010082,0.217410991,0.265827535,0.208400454,0.104755682,0.089595256,
0.009749629,0.043349392,0.123582843,0.225898624,0.264758077,0.332661435,
0.000166240,0.0017234,0.011455602,0.048823625,0.133420438,0.804410695,
0.118324906,0.22133932,0.265473518,0.204156902,0.100667008,0.090038346,
0.012135265,0.050930353,0.137051678,0.236467934,0.261601594,0.301813177,
0.000286379,0.002696578,0.016280421,0.063022926,0.156427004,0.761286694,
0.00759732,0.03599398,0.10934005,0.21296534,0.26596152,0.36814179,
0.00008922,0.00102819,0.00759732,0.03599398,0.10934005,0.84595124,
0.00000018,0.00000496,0.00008922,0.00102819,0.00759732,0.99128013,
0.00974963,0.04334939,0.12358284,0.22589862,0.26475808,0.33266144,
0.00016624,0.00172340,0.01145560,0.04882363,0.13342044,0.80441070,
0.00000057,0.00001366,0.00021173,0.00210401,0.01340593,0.98426410,
0.01213526,0.05093035,0.13705168,0.23646793,0.26160159,0.30181318,
0.00028638,0.00269658,0.01628042,0.06302293,0.15642700,0.76128669,
0.00000156,0.00003285,0.00044501,0.00386494,0.02152292,0.97413273
))
dim(DTI_1_model) <- c(6,3,3,2)
dimnames(DTI_1_model) <- list('DTI_1'=dti_level,'BoERates_1'=boe_level,'Income_1'=income_level,'Spread_1'=spread_level)##add Spread_1
##########
###current implementation####
Defaults_1_model <- list(coef=matrix(c(0.00,0.4,0.04,0.4,0.1,0.4,0.13,0.4,0.16,0.4,0.18,0.4),ncol=6,dimnames=list(c("(Intercept)",'LTV_1'),NULL)),
sd=c(0.01,0.01,0.01,0.01,0.01,0.01))
#dtv_model <- list(coef = matrix(c(1.2, 2.3, 3.4, 4.5), ncol = 2,
#                              dimnames = list(c("(Intercept)", "ltv"), NULL)),
#                sd = c(0.3, 0.6))
defaults_level <- c('1','0')
#Defaults_1_model <- matrix(c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835,0.00222,0.99778,0.00261,0.99739,
#						0.00112,0.99888,0.00110,0.9989,0.00130,0.9987,0.00132,0.99868,0.00186,0.99814,0.00204,0.99796,0.00236,0.99764,0.00302,0.99698,
#						0.00115,0.99885,0.00130,0.9987,0.00132,0.99868,0.00162,0.99838,0.00224,0.99776,0.00249,0.99751,0.00311,0.99689,0.00399,0.99601,
#						0.00136,0.99864,0.00162,0.99838,0.00169,0.99831,0.00167,0.99833,0.00254,0.99746,0.00278,0.99722,0.00369,0.99631,0.00384,0.99616,
#						0.00133,0.99867,0.00188,0.99812,0.00195,0.99805,0.00181,0.99819,0.00259,0.99741,0.00288,0.99712,0.00393,0.99607,0.00466,0.99534,
#						0.00179,0.99821,0.00176,0.99824,0.00175,0.99825,0.00181,0.99819,0.00281,0.99719,0.00307,0.99693,0.00386,0.99614,0.00403,0.99597))
#dim(Defaults_1_model) <- c(2,6,8)
#dimnames(Defaults_1_model) <- list('Defaults_1'=defaults_level,'DTI_1'=dti_level,'LTV_1'=ltv_level)
###specify the node configure
##hpi_model <- matrix(c(0.4, 0.6), ncol = 2, dimnames = list(NULL, c("LOW", "HIGH")))
#Income_1_model <- list(coef = c("(Intercept)" = 0.3), sd = 0.2)#based on page 9 at document.
#Inflation_1_model <- list(coef=c("(Intercept)"=3,"Income_1"=2),sd=1.5)
#BoERates_1_model <- list(coef=c("(Intercept)"=3,"Income_1"=-11.6,"Inflation_1"=2.6),sd=1.5)#
#DTI_1_model <- list(coef=c("(Intercept)"=3,"BoERates_1"=1.6,"Income_1"=-0.6,"LTV_1"=1.2,"Spread_1"=1.3),sd=1.5)#update
##LTV_1_model <- list(coef = c("(Intercept)" = 0.4813), sd = 0.2248)##sd is derived from the table, basically it is a mean.
###estimate from beta distribution with shape1=5,shape2=2, it is transformed data(d = 1.94485, transformed data is (x**d-1)/d.)
###to get the raw LTV data, we need (td+1)**(1/d), t is transformed data, d is 1.94485
#LTV_1_model <- list(coef = c("(Intercept)" = -0.2344), sd = 0.1119)
#Spread_1_model <- list(coef=c("(Intercept)" = 0.013), sd = 0.001)##based on the assumption that the spread is fixed and we model it using peak gaussian.
#Defaults_1_model <- list(coef=c("(Intercept)"=-0.0087,"DTI_1"=0.3034,"LTV_1"=0.3455),sd=0.1)#sd is derived from the default rate sd. Note the weight is multiply by 100 here
#Income_2_model <- list(coef=c("(Intercept)"=3,"BoERates_1"=2),sd=1.5)
#Inflation_2_model <- list(coef=c("(Intercept)"=3,"Income_2"=2),sd=1.5)
#BoERates_2_model <- list(coef=c("(Intercept)"=3,"Income_2"=1.6,"Inflation_2"=-0.6),sd=1.5)
#DTI_2_model <- list(coef=c("(Intercept)"=3,"BoERates_2"=1.6,"Income_2"=-0.6),sd=1.5)
#LTV_2_model <- list(coef = c("(Intercept)" = 8), sd = 1)
#Spread_2_model <- list(coef=c("(Intercept)" = 2), sd = 1)
#Defaults_2_model <- list(coef=c("(Intercept)"=3,"DTI_2"=1.6,"LTV_2"=-0.6,"Spread_2"=2.2),sd=1.5)
###note for 2 discrete nodes, we need to use 8 parameters(4 can be derived from another four)###
###wrap node configure into GRNode class, GRNode_d is for discrete node and GRNode_c is for continous node, parents,children here works
###as place holder
#hpi <- new("GRNode_d",name="hpi",model=list(model=hpi_model),values=c("LOW", "HIGH"),parents=c(NA,NA),children=c(NA,NA))
#Income_1 <- new("GRNode_c",name="Income_1",model=list(model=Income_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
#Inflation_1 <- new("GRNode_c",name="Inflation_1",model=list(model=Inflation_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
#BoERates_1 <- new("GRNode_c",name="BoERates_1",model=list(model=BoERates_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
#DTI_1 <- new("GRNode_c",name="DTI_1",model=list(model=DTI_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
#LTV_1 <- new("GRNode_c",name="LTV_1",model=list(model=LTV_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
#Spread_1 <- new("GRNode_c",name="Spread_1",model=list(model=Spread_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
#Defaults_1 <- new("GRNode_c",name="Defaults_1",model=list(model=Defaults_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
Income_1 <- new("GRNode_d",name="Income_1",model=list(model=Income_1_model),values=income_level,parents=c(NA,NA),children=c(NA,NA))
Inflation_1 <- new("GRNode_d",name="Inflation_1",model=list(model=Inflation_1_model),values=inflation_level,parents=c(NA,NA),children=c(NA,NA))
HPI_1 <- new("GRNode_d",name="HPI_1",model=list(model=HPI_1_model),values=hpi_level,parents=c(NA,NA),children=c(NA,NA))
BoERates_1 <- new("GRNode_d",name="BoERates_1",model=list(model=BoERates_1_model),values=boe_level,parents=c(NA,NA),children=c(NA,NA))
DTI_1 <- new("GRNode_d",name="DTI_1",model=list(model=DTI_1_model),values=dti_level,parents=c(NA,NA),children=c(NA,NA))
LTV_1 <- new("GRNode_c",name="LTV_1",model=list(model=LTV_1_model),values=ltv_level,parents=c(NA,NA),children=c(NA,NA))
Spread_1 <- new("GRNode_d",name="Spread_1",model=list(model=Spread_1_model),values=spread_level,parents=c(NA,NA),children=c(NA,NA))
Defaults_1 <- new("GRNode_c",name="Defaults_1",model=list(model=Defaults_1_model),values=defaults_level,parents=c(NA,NA),children=c(NA,NA))
setClass("GRNode_c",
representation(name="character",model="list",values="vector",parents="vector",children="vector"))
setClass("GRNode_d",
representation(name="character",model="list",values="vector",parents="vector",children="vector"))
income_level <- c('0%','2.5%','5%')
inflation_level <- c('<1.5%','1.5%-2.5%','>2.5%')
boe_level <- c('0.5%','1.5%','2.5%')
spread_level <- c('1%','2%')#new add
hpi_level <- c('-10%','0%','10%')#5% 20% 75% LTV->44% 48% 55%
Income_1_model <- matrix(c(0.1,0.8,0.1),ncol=3,dimnames=list(NULL,'Income_1'=income_level))
#Inflation_1_model <- matrix(c(0.9,0.09,0.01,0.1,0.6,0.3,0.01,0.3,0.69),ncol=3,dimnames=list('Inflation_1'=inflation_level,'Income_1'=income_level))
Inflation_1_model <- matrix(c(0.5,0.4,0.1,0.2,0.4,0.4,0.01,0.39,0.6),ncol=3,dimnames=list('Inflation_1'=inflation_level,'Income_1'=income_level))
HPI_1_model <- matrix(c(0.05,0.20,0.75),ncol=3,dimnames=list(NULL,'HPI_1'=hpi_level))
#HPI_1_model <- matrix(c(0.000,0.20,0.80),ncol=3,dimnames=list(NULL,'HPI_1'=hpi_level))
#BoERates_1_model <- c(0.99,0.005,0.005,0.9,0.09,0.01,0.8,0.19,0.01,0.99,0.005,0.005,0.6,0.39,0.01,0.2,0.6,0.2,0.9,0.09,0.01,0.2,0.7,0.1,0.01,0.4,0.59)
BoERates_1_model <- c(0.82,0.18,0.00,0.62,0.37,0.01,0.36,0.59,0.05,0.36,0.59,0.05,0.16,0.69,0.15,0.05,0.59,0.36,0.05,0.59,0.36,0.01,0.37,0.62,0.00,0.18,0.82)
dim(BoERates_1_model) <- c(3,3,3)
dimnames(BoERates_1_model) <- list('BoERates_1'=boe_level,'Income_1'=income_level,'Inflation_1'=inflation_level)
Spread_1_model <- matrix(c(0.65,0.35),ncol=2,dimnames=list(NULL,'Spread_1'=spread_level))#new add
#LTV_1_model <- list(coef = c("(Intercept)" = 0.4813), sd = 0.2248)
LTV_1_model <- list(coef = matrix(c(0.66,1,0.6,1,0.54,1),ncol=3,dimnames=list(c("(Intercept)","HPI_1"),NULL)), sd = c(0.2,0.2,0.2))
#the below is make up number
ltv_level <-c('<20%','20%-30%','30%-40%','40%-50%','50%-60%','60%-70%','70%-75%','75%+')
#LTV_1_model <- matrix(c(0.02,0.05,0.09,0.14,0.19,0.2,0.19,0.12),ncol=8,dimnames=list(NULL,'LTV_1'=ltv_level))
dti_level <- c('<5%','5%-10%','10%-15%','15%-20%','20%-25%','25%+')
#DTI_1_model <- matrix(c(0.16,0.16,0.16,0.16,0.16,0.20,
#    					0.13,0.14,0.15,0.16,0.18,0.24,
#						0.01,0.02,0.04,0.09,0.20,0.64,
#						0.14,0.16,0.18,0.18,0.16,0.18,
#						0.16,0.18,0.14,0.18,0.16,0.18,
#						0.18,0.18,0.16,0.18,0.16,0.14,
#						0.64,0.20,0.09,0.04,0.02,0.01,
#						0.24,0.18,0.16,0.15,0.14,0.13,
#						0.20,0.16,0.16,0.16,0.16,0.16))
DTI_1_model <- matrix(c(0.10934005,0.212965337,0.26596152,0.212965337,0.10934005,0.089427706,
0.007597324,0.035993978,0.10934005,0.212965337,0.26596152,0.368141791,
0.000089220,0.001028186,0.007597324,0.035993978,0.10934005,0.845951242,
0.114010082,0.217410991,0.265827535,0.208400454,0.104755682,0.089595256,
0.009749629,0.043349392,0.123582843,0.225898624,0.264758077,0.332661435,
0.000166240,0.0017234,0.011455602,0.048823625,0.133420438,0.804410695,
0.118324906,0.22133932,0.265473518,0.204156902,0.100667008,0.090038346,
0.012135265,0.050930353,0.137051678,0.236467934,0.261601594,0.301813177,
0.000286379,0.002696578,0.016280421,0.063022926,0.156427004,0.761286694,
0.00759732,0.03599398,0.10934005,0.21296534,0.26596152,0.36814179,
0.00008922,0.00102819,0.00759732,0.03599398,0.10934005,0.84595124,
0.00000018,0.00000496,0.00008922,0.00102819,0.00759732,0.99128013,
0.00974963,0.04334939,0.12358284,0.22589862,0.26475808,0.33266144,
0.00016624,0.00172340,0.01145560,0.04882363,0.13342044,0.80441070,
0.00000057,0.00001366,0.00021173,0.00210401,0.01340593,0.98426410,
0.01213526,0.05093035,0.13705168,0.23646793,0.26160159,0.30181318,
0.00028638,0.00269658,0.01628042,0.06302293,0.15642700,0.76128669,
0.00000156,0.00003285,0.00044501,0.00386494,0.02152292,0.97413273
))
dim(DTI_1_model) <- c(6,3,3,2)
dimnames(DTI_1_model) <- list('DTI_1'=dti_level,'BoERates_1'=boe_level,'Income_1'=income_level,'Spread_1'=spread_level)##add Spread_1
##########
###current implementation####
Defaults_1_model <- list(coef=matrix(c(0.00,0.4,0.04,0.4,0.1,0.4,0.13,0.4,0.16,0.4,0.18,0.4),ncol=6,dimnames=list(c("(Intercept)",'LTV_1'),NULL)),
sd=c(0.01,0.01,0.01,0.01,0.01,0.01))
#dtv_model <- list(coef = matrix(c(1.2, 2.3, 3.4, 4.5), ncol = 2,
#                              dimnames = list(c("(Intercept)", "ltv"), NULL)),
#                sd = c(0.3, 0.6))
defaults_level <- c('1','0')
#Defaults_1_model <- matrix(c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835,0.00222,0.99778,0.00261,0.99739,
#						0.00112,0.99888,0.00110,0.9989,0.00130,0.9987,0.00132,0.99868,0.00186,0.99814,0.00204,0.99796,0.00236,0.99764,0.00302,0.99698,
#						0.00115,0.99885,0.00130,0.9987,0.00132,0.99868,0.00162,0.99838,0.00224,0.99776,0.00249,0.99751,0.00311,0.99689,0.00399,0.99601,
#						0.00136,0.99864,0.00162,0.99838,0.00169,0.99831,0.00167,0.99833,0.00254,0.99746,0.00278,0.99722,0.00369,0.99631,0.00384,0.99616,
#						0.00133,0.99867,0.00188,0.99812,0.00195,0.99805,0.00181,0.99819,0.00259,0.99741,0.00288,0.99712,0.00393,0.99607,0.00466,0.99534,
#						0.00179,0.99821,0.00176,0.99824,0.00175,0.99825,0.00181,0.99819,0.00281,0.99719,0.00307,0.99693,0.00386,0.99614,0.00403,0.99597))
#dim(Defaults_1_model) <- c(2,6,8)
#dimnames(Defaults_1_model) <- list('Defaults_1'=defaults_level,'DTI_1'=dti_level,'LTV_1'=ltv_level)
###specify the node configure
##hpi_model <- matrix(c(0.4, 0.6), ncol = 2, dimnames = list(NULL, c("LOW", "HIGH")))
#Income_1_model <- list(coef = c("(Intercept)" = 0.3), sd = 0.2)#based on page 9 at document.
#Inflation_1_model <- list(coef=c("(Intercept)"=3,"Income_1"=2),sd=1.5)
#BoERates_1_model <- list(coef=c("(Intercept)"=3,"Income_1"=-11.6,"Inflation_1"=2.6),sd=1.5)#
#DTI_1_model <- list(coef=c("(Intercept)"=3,"BoERates_1"=1.6,"Income_1"=-0.6,"LTV_1"=1.2,"Spread_1"=1.3),sd=1.5)#update
##LTV_1_model <- list(coef = c("(Intercept)" = 0.4813), sd = 0.2248)##sd is derived from the table, basically it is a mean.
###estimate from beta distribution with shape1=5,shape2=2, it is transformed data(d = 1.94485, transformed data is (x**d-1)/d.)
###to get the raw LTV data, we need (td+1)**(1/d), t is transformed data, d is 1.94485
#LTV_1_model <- list(coef = c("(Intercept)" = -0.2344), sd = 0.1119)
#Spread_1_model <- list(coef=c("(Intercept)" = 0.013), sd = 0.001)##based on the assumption that the spread is fixed and we model it using peak gaussian.
#Defaults_1_model <- list(coef=c("(Intercept)"=-0.0087,"DTI_1"=0.3034,"LTV_1"=0.3455),sd=0.1)#sd is derived from the default rate sd. Note the weight is multiply by 100 here
#Income_2_model <- list(coef=c("(Intercept)"=3,"BoERates_1"=2),sd=1.5)
#Inflation_2_model <- list(coef=c("(Intercept)"=3,"Income_2"=2),sd=1.5)
#BoERates_2_model <- list(coef=c("(Intercept)"=3,"Income_2"=1.6,"Inflation_2"=-0.6),sd=1.5)
#DTI_2_model <- list(coef=c("(Intercept)"=3,"BoERates_2"=1.6,"Income_2"=-0.6),sd=1.5)
#LTV_2_model <- list(coef = c("(Intercept)" = 8), sd = 1)
#Spread_2_model <- list(coef=c("(Intercept)" = 2), sd = 1)
#Defaults_2_model <- list(coef=c("(Intercept)"=3,"DTI_2"=1.6,"LTV_2"=-0.6,"Spread_2"=2.2),sd=1.5)
###note for 2 discrete nodes, we need to use 8 parameters(4 can be derived from another four)###
###wrap node configure into GRNode class, GRNode_d is for discrete node and GRNode_c is for continous node, parents,children here works
###as place holder
#hpi <- new("GRNode_d",name="hpi",model=list(model=hpi_model),values=c("LOW", "HIGH"),parents=c(NA,NA),children=c(NA,NA))
#Income_1 <- new("GRNode_c",name="Income_1",model=list(model=Income_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
#Inflation_1 <- new("GRNode_c",name="Inflation_1",model=list(model=Inflation_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
#BoERates_1 <- new("GRNode_c",name="BoERates_1",model=list(model=BoERates_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
#DTI_1 <- new("GRNode_c",name="DTI_1",model=list(model=DTI_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
#LTV_1 <- new("GRNode_c",name="LTV_1",model=list(model=LTV_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
#Spread_1 <- new("GRNode_c",name="Spread_1",model=list(model=Spread_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
#Defaults_1 <- new("GRNode_c",name="Defaults_1",model=list(model=Defaults_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
Income_1 <- new("GRNode_d",name="Income_1",model=list(model=Income_1_model),values=income_level,parents=c(NA,NA),children=c(NA,NA))
Inflation_1 <- new("GRNode_d",name="Inflation_1",model=list(model=Inflation_1_model),values=inflation_level,parents=c(NA,NA),children=c(NA,NA))
HPI_1 <- new("GRNode_d",name="HPI_1",model=list(model=HPI_1_model),values=hpi_level,parents=c(NA,NA),children=c(NA,NA))
BoERates_1 <- new("GRNode_d",name="BoERates_1",model=list(model=BoERates_1_model),values=boe_level,parents=c(NA,NA),children=c(NA,NA))
DTI_1 <- new("GRNode_d",name="DTI_1",model=list(model=DTI_1_model),values=dti_level,parents=c(NA,NA),children=c(NA,NA))
LTV_1 <- new("GRNode_c",name="LTV_1",model=list(model=LTV_1_model),values=ltv_level,parents=c(NA,NA),children=c(NA,NA))
Spread_1 <- new("GRNode_d",name="Spread_1",model=list(model=Spread_1_model),values=spread_level,parents=c(NA,NA),children=c(NA,NA))
Defaults_1 <- new("GRNode_c",name="Defaults_1",model=list(model=Defaults_1_model),values=defaults_level,parents=c(NA,NA),children=c(NA,NA))
Defaults_1@model
Defaults_1@model[1]
Defaults_1@model[[1]]
setClass("GRNode_c",
representation(name="character",model="list",values="vector",parents="vector",children="vector"))
setClass("GRNode_d",
representation(name="character",model="list",values="vector",parents="vector",children="vector"))
###add some method to here###
setGeneric("setValues",function(the_obj,values){
standardGeneric("setValues")
})
setMethod(f="setValues",
signature="GRNode_c",
definition=function(the_obj,values){
the_obj@values <- values
return(the_obj)
})
setMethod(f="setValues",
signature="GRNode_d",
definition=function(the_obj,values){
the_obj@values <- values
return(the_obj)
})
setGeneric("getValues",function(the_obj){
standardGeneric("getValues")
})
setMethod(f="getValues",
signature="GRNode_c",
definition=function(the_obj){
return(the_obj@values)
})
setMethod(f="getValues",
signature="GRNode_d",
definition=function(the_obj){
return(the_obj@values)
})
setGeneric("setName",function(the_obj,name){
standardGeneric("setName")
})
setMethod(f="setName",
signature="GRNode_c",
definition=function(the_obj,name){
the_obj@name <- name
return(the_obj)
})
setMethod(f="setName",
signature="GRNode_d",
definition=function(the_obj,name){
the_obj@name <- name
return(the_obj)
})
setGeneric("getName",function(the_obj){
standardGeneric("getName")
})
setMethod(f="getName",
signature="GRNode_c",
definition=function(the_obj){
return(the_obj@name)
})
setMethod(f="getName",
signature="GRNode_d",
definition=function(the_obj){
return(the_obj@name)
})
setGeneric("getModel",function(the_obj){
standardGeneric("getModel")
})
setMethod(f="getModel",
signature="GRNode_c",
definition=function(the_obj){
return(the_obj@model)
})
setMethod(f="getModel",
signature="GRNode_d",
definition=function(the_obj){
return(the_obj@model)
})
setGeneric("setModel",function(the_obj,model){
standardGeneric("setModel")
})
setMethod(f="setModel",
signature="GRNode_c",
definition=function(the_obj,model){
the_obj@model <- model
return(the_obj)
})
setMethod(f="setModel",
signature="GRNode_d",
definition=function(the_obj,model){
the_obj@model[[1]] <- model
return(the_obj)
})
income_level <- c('0%','2.5%','5%')
inflation_level <- c('<1.5%','1.5%-2.5%','>2.5%')
boe_level <- c('0.5%','1.5%','2.5%')
spread_level <- c('1%','2%')#new add
hpi_level <- c('-10%','0%','10%')#5% 20% 75% LTV->44% 48% 55%
Income_1_model <- matrix(c(0.1,0.8,0.1),ncol=3,dimnames=list(NULL,'Income_1'=income_level))
#Inflation_1_model <- matrix(c(0.9,0.09,0.01,0.1,0.6,0.3,0.01,0.3,0.69),ncol=3,dimnames=list('Inflation_1'=inflation_level,'Income_1'=income_level))
Inflation_1_model <- matrix(c(0.5,0.4,0.1,0.2,0.4,0.4,0.01,0.39,0.6),ncol=3,dimnames=list('Inflation_1'=inflation_level,'Income_1'=income_level))
HPI_1_model <- matrix(c(0.05,0.20,0.75),ncol=3,dimnames=list(NULL,'HPI_1'=hpi_level))
#HPI_1_model <- matrix(c(0.000,0.20,0.80),ncol=3,dimnames=list(NULL,'HPI_1'=hpi_level))
#BoERates_1_model <- c(0.99,0.005,0.005,0.9,0.09,0.01,0.8,0.19,0.01,0.99,0.005,0.005,0.6,0.39,0.01,0.2,0.6,0.2,0.9,0.09,0.01,0.2,0.7,0.1,0.01,0.4,0.59)
BoERates_1_model <- c(0.82,0.18,0.00,0.62,0.37,0.01,0.36,0.59,0.05,0.36,0.59,0.05,0.16,0.69,0.15,0.05,0.59,0.36,0.05,0.59,0.36,0.01,0.37,0.62,0.00,0.18,0.82)
dim(BoERates_1_model) <- c(3,3,3)
dimnames(BoERates_1_model) <- list('BoERates_1'=boe_level,'Income_1'=income_level,'Inflation_1'=inflation_level)
Spread_1_model <- matrix(c(0.65,0.35),ncol=2,dimnames=list(NULL,'Spread_1'=spread_level))#new add
#LTV_1_model <- list(coef = c("(Intercept)" = 0.4813), sd = 0.2248)
LTV_1_model <- list(coef = matrix(c(0.66,1,0.6,1,0.54,1),ncol=3,dimnames=list(c("(Intercept)","HPI_1"),NULL)), sd = c(0.2,0.2,0.2))
#the below is make up number
ltv_level <-c('<20%','20%-30%','30%-40%','40%-50%','50%-60%','60%-70%','70%-75%','75%+')
#LTV_1_model <- matrix(c(0.02,0.05,0.09,0.14,0.19,0.2,0.19,0.12),ncol=8,dimnames=list(NULL,'LTV_1'=ltv_level))
dti_level <- c('<5%','5%-10%','10%-15%','15%-20%','20%-25%','25%+')
#DTI_1_model <- matrix(c(0.16,0.16,0.16,0.16,0.16,0.20,
#    					0.13,0.14,0.15,0.16,0.18,0.24,
#						0.01,0.02,0.04,0.09,0.20,0.64,
#						0.14,0.16,0.18,0.18,0.16,0.18,
#						0.16,0.18,0.14,0.18,0.16,0.18,
#						0.18,0.18,0.16,0.18,0.16,0.14,
#						0.64,0.20,0.09,0.04,0.02,0.01,
#						0.24,0.18,0.16,0.15,0.14,0.13,
#						0.20,0.16,0.16,0.16,0.16,0.16))
DTI_1_model <- matrix(c(0.10934005,0.212965337,0.26596152,0.212965337,0.10934005,0.089427706,
0.007597324,0.035993978,0.10934005,0.212965337,0.26596152,0.368141791,
0.000089220,0.001028186,0.007597324,0.035993978,0.10934005,0.845951242,
0.114010082,0.217410991,0.265827535,0.208400454,0.104755682,0.089595256,
0.009749629,0.043349392,0.123582843,0.225898624,0.264758077,0.332661435,
0.000166240,0.0017234,0.011455602,0.048823625,0.133420438,0.804410695,
0.118324906,0.22133932,0.265473518,0.204156902,0.100667008,0.090038346,
0.012135265,0.050930353,0.137051678,0.236467934,0.261601594,0.301813177,
0.000286379,0.002696578,0.016280421,0.063022926,0.156427004,0.761286694,
0.00759732,0.03599398,0.10934005,0.21296534,0.26596152,0.36814179,
0.00008922,0.00102819,0.00759732,0.03599398,0.10934005,0.84595124,
0.00000018,0.00000496,0.00008922,0.00102819,0.00759732,0.99128013,
0.00974963,0.04334939,0.12358284,0.22589862,0.26475808,0.33266144,
0.00016624,0.00172340,0.01145560,0.04882363,0.13342044,0.80441070,
0.00000057,0.00001366,0.00021173,0.00210401,0.01340593,0.98426410,
0.01213526,0.05093035,0.13705168,0.23646793,0.26160159,0.30181318,
0.00028638,0.00269658,0.01628042,0.06302293,0.15642700,0.76128669,
0.00000156,0.00003285,0.00044501,0.00386494,0.02152292,0.97413273
))
dim(DTI_1_model) <- c(6,3,3,2)
dimnames(DTI_1_model) <- list('DTI_1'=dti_level,'BoERates_1'=boe_level,'Income_1'=income_level,'Spread_1'=spread_level)##add Spread_1
##########
###current implementation####
Defaults_1_model <- list(coef=matrix(c(0.00,0.4,0.04,0.4,0.1,0.4,0.13,0.4,0.16,0.4,0.18,0.4),ncol=6,dimnames=list(c("(Intercept)",'LTV_1'),NULL)),
sd=c(0.01,0.01,0.01,0.01,0.01,0.01))
#dtv_model <- list(coef = matrix(c(1.2, 2.3, 3.4, 4.5), ncol = 2,
#                              dimnames = list(c("(Intercept)", "ltv"), NULL)),
#                sd = c(0.3, 0.6))
defaults_level <- c('1','0')
#Defaults_1_model <- matrix(c(0.001,0.999,0.00088,0.99912,0.00108,0.99892,0.1,0.9,0.00139,0.99861,0.00165,0.99835,0.00222,0.99778,0.00261,0.99739,
#						0.00112,0.99888,0.00110,0.9989,0.00130,0.9987,0.00132,0.99868,0.00186,0.99814,0.00204,0.99796,0.00236,0.99764,0.00302,0.99698,
#						0.00115,0.99885,0.00130,0.9987,0.00132,0.99868,0.00162,0.99838,0.00224,0.99776,0.00249,0.99751,0.00311,0.99689,0.00399,0.99601,
#						0.00136,0.99864,0.00162,0.99838,0.00169,0.99831,0.00167,0.99833,0.00254,0.99746,0.00278,0.99722,0.00369,0.99631,0.00384,0.99616,
#						0.00133,0.99867,0.00188,0.99812,0.00195,0.99805,0.00181,0.99819,0.00259,0.99741,0.00288,0.99712,0.00393,0.99607,0.00466,0.99534,
#						0.00179,0.99821,0.00176,0.99824,0.00175,0.99825,0.00181,0.99819,0.00281,0.99719,0.00307,0.99693,0.00386,0.99614,0.00403,0.99597))
#dim(Defaults_1_model) <- c(2,6,8)
#dimnames(Defaults_1_model) <- list('Defaults_1'=defaults_level,'DTI_1'=dti_level,'LTV_1'=ltv_level)
###specify the node configure
##hpi_model <- matrix(c(0.4, 0.6), ncol = 2, dimnames = list(NULL, c("LOW", "HIGH")))
#Income_1_model <- list(coef = c("(Intercept)" = 0.3), sd = 0.2)#based on page 9 at document.
#Inflation_1_model <- list(coef=c("(Intercept)"=3,"Income_1"=2),sd=1.5)
#BoERates_1_model <- list(coef=c("(Intercept)"=3,"Income_1"=-11.6,"Inflation_1"=2.6),sd=1.5)#
#DTI_1_model <- list(coef=c("(Intercept)"=3,"BoERates_1"=1.6,"Income_1"=-0.6,"LTV_1"=1.2,"Spread_1"=1.3),sd=1.5)#update
##LTV_1_model <- list(coef = c("(Intercept)" = 0.4813), sd = 0.2248)##sd is derived from the table, basically it is a mean.
###estimate from beta distribution with shape1=5,shape2=2, it is transformed data(d = 1.94485, transformed data is (x**d-1)/d.)
###to get the raw LTV data, we need (td+1)**(1/d), t is transformed data, d is 1.94485
#LTV_1_model <- list(coef = c("(Intercept)" = -0.2344), sd = 0.1119)
#Spread_1_model <- list(coef=c("(Intercept)" = 0.013), sd = 0.001)##based on the assumption that the spread is fixed and we model it using peak gaussian.
#Defaults_1_model <- list(coef=c("(Intercept)"=-0.0087,"DTI_1"=0.3034,"LTV_1"=0.3455),sd=0.1)#sd is derived from the default rate sd. Note the weight is multiply by 100 here
#Income_2_model <- list(coef=c("(Intercept)"=3,"BoERates_1"=2),sd=1.5)
#Inflation_2_model <- list(coef=c("(Intercept)"=3,"Income_2"=2),sd=1.5)
#BoERates_2_model <- list(coef=c("(Intercept)"=3,"Income_2"=1.6,"Inflation_2"=-0.6),sd=1.5)
#DTI_2_model <- list(coef=c("(Intercept)"=3,"BoERates_2"=1.6,"Income_2"=-0.6),sd=1.5)
#LTV_2_model <- list(coef = c("(Intercept)" = 8), sd = 1)
#Spread_2_model <- list(coef=c("(Intercept)" = 2), sd = 1)
#Defaults_2_model <- list(coef=c("(Intercept)"=3,"DTI_2"=1.6,"LTV_2"=-0.6,"Spread_2"=2.2),sd=1.5)
###note for 2 discrete nodes, we need to use 8 parameters(4 can be derived from another four)###
###wrap node configure into GRNode class, GRNode_d is for discrete node and GRNode_c is for continous node, parents,children here works
###as place holder
#hpi <- new("GRNode_d",name="hpi",model=list(model=hpi_model),values=c("LOW", "HIGH"),parents=c(NA,NA),children=c(NA,NA))
#Income_1 <- new("GRNode_c",name="Income_1",model=list(model=Income_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
#Inflation_1 <- new("GRNode_c",name="Inflation_1",model=list(model=Inflation_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
#BoERates_1 <- new("GRNode_c",name="BoERates_1",model=list(model=BoERates_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
#DTI_1 <- new("GRNode_c",name="DTI_1",model=list(model=DTI_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
#LTV_1 <- new("GRNode_c",name="LTV_1",model=list(model=LTV_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
#Spread_1 <- new("GRNode_c",name="Spread_1",model=list(model=Spread_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
#Defaults_1 <- new("GRNode_c",name="Defaults_1",model=list(model=Defaults_1_model),values=c(-10000,10000),parents=c(NA,NA),children=c(NA,NA))
Income_1 <- new("GRNode_d",name="Income_1",model=list(model=Income_1_model),values=income_level,parents=c(NA,NA),children=c(NA,NA))
Inflation_1 <- new("GRNode_d",name="Inflation_1",model=list(model=Inflation_1_model),values=inflation_level,parents=c(NA,NA),children=c(NA,NA))
HPI_1 <- new("GRNode_d",name="HPI_1",model=list(model=HPI_1_model),values=hpi_level,parents=c(NA,NA),children=c(NA,NA))
BoERates_1 <- new("GRNode_d",name="BoERates_1",model=list(model=BoERates_1_model),values=boe_level,parents=c(NA,NA),children=c(NA,NA))
DTI_1 <- new("GRNode_d",name="DTI_1",model=list(model=DTI_1_model),values=dti_level,parents=c(NA,NA),children=c(NA,NA))
LTV_1 <- new("GRNode_c",name="LTV_1",model=list(model=LTV_1_model),values=ltv_level,parents=c(NA,NA),children=c(NA,NA))
Spread_1 <- new("GRNode_d",name="Spread_1",model=list(model=Spread_1_model),values=spread_level,parents=c(NA,NA),children=c(NA,NA))
Defaults_1 <- new("GRNode_c",name="Defaults_1",model=list(model=Defaults_1_model),values=defaults_level,parents=c(NA,NA),children=c(NA,NA))
getModel(Defaults_1)
getModel(DTI_1)
setwd('C:\\Projects\\BayesianNetwork\\Netscene')
library(shiny)
runApp()
setwd('C:\\Projects\\BayesianNetwork\\Netscene06Jan2015')
runApp()
income_level <- c('0%','2.5%','5%')
inflation_level <- c('<1.5%','1.5%-2.5%','>2.5%')
boe_level <- c('0.5%','1.5%','2.5%')
spread_level <- c('1%','2%')#new add
hpi_level <- c('-10%','0%','10%')#5% 20% 75% LTV->44% 48% 55%
Income_1_model <- matrix(c(0.1,0.8,0.1),ncol=3,dimnames=list(NULL,'Income_1'=income_level))
#Inflation_1_model <- matrix(c(0.9,0.09,0.01,0.1,0.6,0.3,0.01,0.3,0.69),ncol=3,dimnames=list('Inflation_1'=inflation_level,'Income_1'=income_level))
Inflation_1_model <- matrix(c(0.5,0.4,0.1,0.2,0.4,0.4,0.01,0.39,0.6),ncol=3,dimnames=list('Inflation_1'=inflation_level,'Income_1'=income_level))
Inflation_1_model
setwd('C:\\Projects\\BayesianNetwork\\Netscene')
library(shiny)
runApp()
